<!DOCTYPE html>
<!-- Category: Health -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Cycling Calorie Burn Calculator - Calculate calories burned during cycling based on weight, speed, and duration. Track your cycling workouts and fitness progress.">
    <meta name="keywords" content="cycling calorie calculator, bike calorie burn, cycling workout tracker, exercise calorie counter, fitness calculator, cycling nutrition, bike fitness">
    <title>Cycling Calorie Burn Calculator - Track Your Cycling Workouts</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --warning: #f72585;
            --danger: #e63946;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --border: #dee2e6;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --card-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 0;
        }
        
        /* Desktop Styles */
        header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 0 20px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
        }
        
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: var(--card-shadow);
            padding: 25px;
            margin-bottom: 25px;
            transition: all 0.3s ease;
            border: 1px solid rgba(0,0,0,0.05);
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.15);
        }
        
        h1, h2, h3 {
            margin-bottom: 15px;
            color: var(--dark);
        }
        
        h1 {
            font-size: 1.8rem;
            text-align: center;
            margin: 0;
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        
        h2 {
            font-size: 1.5rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        h2 i {
            font-size: 1.2rem;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .btn:hover {
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--secondary);
        }
        
        .btn-warning {
            background: var(--warning);
            color: white;
        }
        
        .btn-warning:hover {
            opacity: 0.9;
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            opacity: 0.9;
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }
        
        .btn-success {
            background: #2a9d8f;
            color: white;
        }
        
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        
        .result-container {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            margin: 25px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .result-value {
            font-size: 3rem;
            font-weight: 800;
            margin: 15px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .result-label {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            text-align: center;
            padding: 25px;
            background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 1rem;
            font-weight: 600;
        }
        
        .stat-icon {
            font-size: 2rem;
            color: var(--primary);
        }
        
        .workout-list {
            list-style: none;
        }
        
        .workout-item {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .workout-item:last-child {
            border-bottom: none;
        }
        
        .workout-info {
            flex: 1;
        }
        
        .workout-title {
            font-weight: 600;
            color: var(--dark);
            font-size: 1.1rem;
        }
        
        .workout-meta {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .workout-date {
            color: var(--gray);
            font-size: 0.8rem;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            box-shadow: var(--shadow);
            z-index: 1000;
            transform: translateX(200%);
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background: #28a745;
        }
        
        .notification.error {
            background: #dc3545;
        }
        
        .notification.warning {
            background: #ffc107;
            color: #212529;
        }
        
        .hidden {
            display: none;
        }
        
        /* Additional Features */
        .unit-toggle {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        
        .unit-btn {
            padding: 8px 15px;
            border-radius: 20px;
            border: 2px solid var(--border);
            background: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .unit-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .theme-selector {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .theme-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 2px solid white;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .theme-btn.active {
            transform: scale(1.2);
            box-shadow: 0 0 0 3px white, 0 0 0 5px var(--primary);
        }
        
        .workout-actions {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            padding: 8px 12px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            background: #e9ecef;
            color: var(--dark);
            transition: all 0.3s;
        }
        
        .action-btn:hover {
            background: var(--primary);
            color: white;
        }
        
        .cycling-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .cycling-type {
            padding: 15px;
            border: 2px solid var(--border);
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .cycling-type:hover {
            border-color: var(--primary);
            background: rgba(67, 97, 238, 0.05);
        }
        
        .cycling-type.active {
            border-color: var(--primary);
            background: rgba(67, 97, 238, 0.1);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .cycling-type i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .filter-controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin: 15px 0;
            align-items: center;
        }
        
        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .search-box {
            flex: 1;
            max-width: 300px;
        }
        
        .achievement-card {
            background: linear-gradient(135deg, #ffd166 0%, #ffb700 100%);
            color: #333;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            font-weight: 600;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .chart-container {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .chart-title {
            text-align: center;
            margin-bottom: 15px;
            color: var(--dark);
            font-weight: 600;
        }
        
        .chart {
            height: 200px;
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            gap: 10px;
            padding: 20px 0;
        }
        
        .chart-bar {
            flex: 1;
            background: linear-gradient(to top, var(--primary), var(--success));
            border-radius: 8px 8px 0 0;
            min-width: 30px;
            position: relative;
            transition: height 0.5s ease;
        }
        
        .chart-bar-label {
            position: absolute;
            bottom: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        .chart-bar-value {
            position: absolute;
            top: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--dark);
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--primary);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .progress-ring {
            width: 120px;
            height: 120px;
            margin: 0 auto 20px;
        }
        
        .progress-ring-circle {
            stroke: #e9ecef;
            stroke-width: 8;
            fill: transparent;
        }
        
        .progress-ring-circle-progress {
            stroke: var(--primary);
            stroke-width: 8;
            fill: transparent;
            stroke-linecap: round;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        
        .progress-text {
            text-anchor: middle;
            dominant-baseline: middle;
            font-size: 20px;
            font-weight: bold;
            fill: var(--primary);
        }
        
        /* Mobile Styles */
        @media (max-width: 768px) {
            header {
                height: 50px;
                padding: 0 15px;
            }
            
            h1 {
                font-size: 1.4rem;
            }
            
            .container {
                margin: 15px auto;
                padding: 0 15px;
            }
            
            .card {
                padding: 20px;
                margin-bottom: 20px;
            }
            
            .result-value {
                font-size: 2.5rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr 1fr;
                gap: 15px;
            }
            
            .stat-value {
                font-size: 1.8rem;
            }
            
            .stat-card {
                padding: 15px;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 14px;
            }
            
            .workout-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .workout-meta {
                width: 100%;
                justify-content: space-between;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
            }
            
            .filter-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box {
                max-width: 100%;
            }
            
            .cycling-types {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .chart {
                height: 150px;
            }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .flip {
            animation: flip 0.6s ease;
        }
        
        @keyframes flip {
            0% { transform: rotateY(0); }
            50% { transform: rotateY(90deg); }
            100% { transform: rotateY(0); }
        }
        
        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            background: var(--primary);
            color: white;
        }
    </style>
</head>
<body>
    <header>
        <h1><i class="fas fa-bicycle"></i> Cycling Calorie Burn Calculator</h1>
    </header>
    
    <div class="container">
        <div class="card">
            <h2><i class="fas fa-calculator"></i> Calculate Calories Burned</h2>
            <div class="form-group">
                <label for="weight"><i class="fas fa-weight"></i> Weight</label>
                <div class="unit-toggle">
                    <button class="unit-btn active" data-unit="kg">kg</button>
                    <button class="unit-btn" data-unit="lbs">lbs</button>
                </div>
                <input type="number" id="weight" min="20" max="300" step="0.1" placeholder="Enter your weight">
            </div>
            
            <div class="form-group">
                <label for="cyclingType"><i class="fas fa-biking"></i> Cycling Type</label>
                <div class="cycling-types">
                    <div class="cycling-type active" data-type="leisure">
                        <i class="fas fa-bicycle"></i>
                        <div>Leisure</div>
                        <div style="font-size: 0.8rem; color: var(--gray);">10-12 mph</div>
                    </div>
                    <div class="cycling-type" data-type="moderate">
                        <i class="fas fa-biking"></i>
                        <div>Moderate</div>
                        <div style="font-size: 0.8rem; color: var(--gray);">12-14 mph</div>
                    </div>
                    <div class="cycling-type" data-type="vigorous">
                        <i class="fas fa-biking"></i>
                        <div>Vigorous</div>
                        <div style="font-size: 0.8rem; color: var(--gray);">14-16 mph</div>
                    </div>
                    <div class="cycling-type" data-type="racing">
                        <i class="fas fa-tachometer-alt"></i>
                        <div>Racing</div>
                        <div style="font-size: 0.8rem; color: var(--gray);">16+ mph</div>
                    </div>
                </div>
                <input type="hidden" id="cyclingType" value="leisure">
            </div>
            
            <div class="form-group">
                <label for="duration"><i class="fas fa-clock"></i> Duration (minutes)</label>
                <input type="number" id="duration" min="1" max="600" value="30" placeholder="Enter duration in minutes">
            </div>
            
            <div class="form-group">
                <label for="distance"><i class="fas fa-road"></i> Distance (optional)</label>
                <div class="unit-toggle">
                    <button class="unit-btn active" data-distance-unit="km">km</button>
                    <button class="unit-btn" data-distance-unit="mi">mi</button>
                </div>
                <input type="number" id="distance" min="0" step="0.1" placeholder="Enter distance traveled">
                <input type="hidden" id="distanceUnit" value="km">
            </div>
            
            <div class="form-group">
                <label for="intensity"><i class="fas fa-tachometer-alt"></i> Intensity Level</label>
                <select id="intensity">
                    <option value="1">Light (Recreational)</option>
                    <option value="1.2" selected>Moderate</option>
                    <option value="1.5">Vigorous</option>
                    <option value="1.8">Very Vigorous</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="terrain"><i class="fas fa-mountain"></i> Terrain</label>
                <select id="terrain">
                    <option value="1">Flat</option>
                    <option value="1.2">Slight Hills</option>
                    <option value="1.5">Hilly</option>
                    <option value="1.8">Mountainous</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="weather"><i class="fas fa-cloud-sun"></i> Weather Conditions</label>
                <select id="weather">
                    <option value="1">Ideal</option>
                    <option value="1.1">Mild Wind</option>
                    <option value="1.2">Strong Wind</option>
                    <option value="0.9">Cool Weather</option>
                    <option value="1.1">Hot Weather</option>
                </select>
            </div>
            
            <div class="controls">
                <button class="btn btn-primary" id="calculateBtn"><i class="fas fa-calculator"></i> Calculate</button>
                <button class="btn btn-success" id="saveWorkoutBtn"><i class="fas fa-save"></i> Save Workout</button>
                <button class="btn btn-info" id="chartsBtn"><i class="fas fa-chart-bar"></i> Charts</button>
                <button class="btn btn-outline" id="achievementsBtn"><i class="fas fa-trophy"></i> Achievements</button>
            </div>
        </div>
        
        <div class="result-container">
            <div class="result-label">Estimated Calories Burned</div>
            <div class="result-value" id="caloriesResult">0</div>
            <div class="result-label" id="caloriesDescription">Based on your input</div>
            <div class="progress-ring">
                <svg width="120" height="120">
                    <circle class="progress-ring-circle" cx="60" cy="60" r="50"></circle>
                    <circle class="progress-ring-circle-progress" cx="60" cy="60" r="50" id="progressCircle"></circle>
                    <text class="progress-text" x="60" y="60" id="progressText">0%</text>
                </svg>
            </div>
        </div>
        
        <div class="card">
            <h2><i class="fas fa-tachometer-alt"></i> Cycling Statistics</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <i class="fas fa-fire stat-icon"></i>
                    <div class="stat-value" id="totalCalories">0</div>
                    <div class="stat-label">Total Calories</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-bicycle stat-icon"></i>
                    <div class="stat-value" id="totalWorkouts">0</div>
                    <div class="stat-label">Workouts</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-clock stat-icon"></i>
                    <div class="stat-value" id="totalTime">0</div>
                    <div class="stat-label">Total Time (min)</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-trophy stat-icon"></i>
                    <div class="stat-value" id="bestWorkout">0</div>
                    <div class="stat-label">Best Workout</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-route stat-icon"></i>
                    <div class="stat-value" id="totalDistance">0</div>
                    <div class="stat-label">Total Distance</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-fire-alt stat-icon"></i>
                    <div class="stat-value" id="avgCalories">0</div>
                    <div class="stat-label">Avg Calories</div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2><i class="fas fa-chart-line"></i> Weekly Progress</h2>
            <div class="chart-container">
                <div class="chart" id="weeklyChart">
                    <!-- Chart bars will be generated by JavaScript -->
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2><i class="fas fa-history"></i> Recent Workouts</h2>
            <div class="filter-controls">
                <div class="search-box">
                    <input type="text" id="searchWorkouts" placeholder="Search workouts..." class="form-control">
                </div>
                <div class="filter-group">
                    <label><i class="fas fa-sort"></i> Sort by:</label>
                    <select id="sortWorkouts">
                        <option value="date">Date</option>
                        <option value="calories">Calories</option>
                        <option value="duration">Duration</option>
                        <option value="distance">Distance</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label><i class="fas fa-filter"></i> Filter:</label>
                    <select id="filterWorkouts">
                        <option value="all">All Workouts</option>
                        <option value="last7">Last 7 Days</option>
                        <option value="last30">Last 30 Days</option>
                        <option value="high-cal">High Calorie (>300)</option>
                    </select>
                </div>
            </div>
            <ul class="workout-list" id="workoutList">
                <li class="workout-item">No workouts recorded yet</li>
            </ul>
        </div>
        
        <div class="card">
            <h2><i class="fas fa-cog"></i> Settings</h2>
            <div class="form-group">
                <label><i class="fas fa-palette"></i> Theme</label>
                <div class="theme-selector">
                    <div class="theme-btn active" style="background: #4361ee;" data-theme="blue"></div>
                    <div class="theme-btn" style="background: #2a9d8f;" data-theme="green"></div>
                    <div class="theme-btn" style="background: #e76f51;" data-theme="orange"></div>
                    <div class="theme-btn" style="background: #9b5de5;" data-theme="purple"></div>
                </div>
            </div>
            <div class="form-group">
                <label><i class="fas fa-bell"></i> Notifications</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="notificationsToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="form-group">
                <label><i class="fas fa-bullseye"></i> Weekly Goal (calories)</label>
                <input type="number" id="weeklyGoal" min="0" value="2000" placeholder="Enter weekly calorie goal">
            </div>
        </div>
        
        <div class="card">
            <h2><i class="fas fa-trash-alt"></i> Data Management</h2>
            <p>Your cycling data is automatically saved to your device. You can clear all data if needed.</p>
            <button class="btn btn-danger" id="clearDataBtn"><i class="fas fa-trash"></i> Clear All Data</button>
            <button class="btn btn-outline" id="exportDataBtn" style="margin-left: 10px;"><i class="fas fa-download"></i> Export Data</button>
            <button class="btn btn-outline" id="importDataBtn" style="margin-left: 10px;"><i class="fas fa-upload"></i> Import Data</button>
        </div>
    </div>
    
    <!-- Charts Modal -->
    <div class="card hidden" id="chartsModal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000; width: 90%; max-width: 800px; max-height: 90vh; overflow-y: auto;">
        <h2><i class="fas fa-chart-bar"></i> Cycling Analytics</h2>
        <div class="chart-container">
            <div class="chart-title">Calories Burned by Week</div>
            <div class="chart" id="caloriesChart">
                <!-- Calories chart bars -->
            </div>
        </div>
        <div class="chart-container">
            <div class="chart-title">Workouts by Type</div>
            <div class="chart" id="typeChart">
                <!-- Type chart bars -->
            </div>
        </div>
        <div class="chart-container">
            <div class="chart-title">Monthly Progress</div>
            <div class="chart" id="monthlyChart">
                <!-- Monthly chart bars -->
            </div>
        </div>
        <div class="controls">
            <button class="btn btn-outline" id="closeChartsBtn"><i class="fas fa-times"></i> Close</button>
        </div>
    </div>
    
    <!-- Achievements Modal -->
    <div class="card hidden" id="achievementsModal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto;">
        <h2><i class="fas fa-trophy"></i> Cycling Achievements</h2>
        <div id="achievementsList">
            <!-- Achievements will be populated by JavaScript -->
        </div>
        <div class="controls">
            <button class="btn btn-outline" id="closeAchievementsBtn"><i class="fas fa-times"></i> Close</button>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>
    
    <script>
        // DOM Elements
        const weightInput = document.getElementById('weight');
        const cyclingTypeInput = document.getElementById('cyclingType');
        const durationInput = document.getElementById('duration');
        const distanceInput = document.getElementById('distance');
        const distanceUnitInput = document.getElementById('distanceUnit');
        const intensitySelect = document.getElementById('intensity');
        const terrainSelect = document.getElementById('terrain');
        const weatherSelect = document.getElementById('weather');
        const calculateBtn = document.getElementById('calculateBtn');
        const saveWorkoutBtn = document.getElementById('saveWorkoutBtn');
        const chartsBtn = document.getElementById('chartsBtn');
        const achievementsBtn = document.getElementById('achievementsBtn');
        const clearDataBtn = document.getElementById('clearDataBtn');
        const exportDataBtn = document.getElementById('exportDataBtn');
        const importDataBtn = document.getElementById('importDataBtn');
        const workoutList = document.getElementById('workoutList');
        const notification = document.getElementById('notification');
        const unitButtons = document.querySelectorAll('.unit-btn[data-unit]');
        const distanceUnitButtons = document.querySelectorAll('.unit-btn[data-distance-unit]');
        const cyclingTypes = document.querySelectorAll('.cycling-type');
        const themeButtons = document.querySelectorAll('.theme-btn');
        const notificationsToggle = document.getElementById('notificationsToggle');
        const weeklyGoalInput = document.getElementById('weeklyGoal');
        const searchWorkouts = document.getElementById('searchWorkouts');
        const sortWorkouts = document.getElementById('sortWorkouts');
        const filterWorkouts = document.getElementById('filterWorkouts');
        const closeChartsBtn = document.getElementById('closeChartsBtn');
        const closeAchievementsBtn = document.getElementById('closeAchievementsBtn');
        const chartsModal = document.getElementById('chartsModal');
        const achievementsModal = document.getElementById('achievementsModal');
        const achievementsList = document.getElementById('achievementsList');
        const weeklyChart = document.getElementById('weeklyChart');
        const caloriesChart = document.getElementById('caloriesChart');
        const typeChart = document.getElementById('typeChart');
        const monthlyChart = document.getElementById('monthlyChart');
        
        // Result Elements
        const caloriesResult = document.getElementById('caloriesResult');
        const caloriesDescription = document.getElementById('caloriesDescription');
        const progressCircle = document.getElementById('progressCircle');
        const progressText = document.getElementById('progressText');
        
        // Stats Elements
        const totalCaloriesEl = document.getElementById('totalCalories');
        const totalWorkoutsEl = document.getElementById('totalWorkouts');
        const totalTimeEl = document.getElementById('totalTime');
        const bestWorkoutEl = document.getElementById('bestWorkout');
        const totalDistanceEl = document.getElementById('totalDistance');
        const avgCaloriesEl = document.getElementById('avgCalories');
        
        // Data
        let workouts = [];
        let stats = {
            totalCalories: 0,
            totalWorkouts: 0,
            totalTime: 0,
            bestWorkout: 0,
            totalDistance: 0
        };
        
        let achievements = [
            { id: 1, name: "First Ride", description: "Complete your first cycling workout", unlocked: false, icon: "fas fa-bicycle" },
            { id: 2, name: "Calorie Crusher", description: "Burn 500 calories in a single workout", unlocked: false, icon: "fas fa-fire" },
            { id: 3, name: "Week Warrior", description: "Complete 5 workouts in a week", unlocked: false, icon: "fas fa-calendar-week" },
            { id: 4, name: "Distance Master", description: "Cycle 50km in total", unlocked: false, icon: "fas fa-route" },
            { id: 5, name: "Marathon Cyclist", description: "Cycle for 60 minutes straight", unlocked: false, icon: "fas fa-hourglass-half" },
            { id: 6, name: "Consistency King", description: "Cycle for 30 days straight", unlocked: false, icon: "fas fa-crown" },
            { id: 7, name: "Calorie Champion", description: "Burn 5000 calories in total", unlocked: false, icon: "fas fa-trophy" },
            { id: 8, name: "Mountain Climber", description: "Cycle on mountainous terrain", unlocked: false, icon: "fas fa-mountain" }
        ];
        
        let currentUnit = 'kg';
        let currentDistanceUnit = 'km';
        let currentTheme = 'blue';
        let notificationsEnabled = true;
        let weeklyGoal = 2000;
        
        // Themes
        const themes = {
            blue: { primary: '#4361ee', secondary: '#3f37c9' },
            green: { primary: '#2a9d8f', secondary: '#264653' },
            orange: { primary: '#e76f51', secondary: '#f4a261' },
            purple: { primary: '#9b5de5', secondary: '#7209b7' }
        };
        
        // Cycling type MET values (Metabolic Equivalent of Task)
        const cyclingMETs = {
            leisure: 4.0,
            moderate: 6.0,
            vigorous: 8.0,
            racing: 10.0
        };
        
        // Initialize
        function init() {
            loadSettings();
            loadWorkouts();
            loadStats();
            loadAchievements();
            updateStatsDisplay();
            updateWorkoutList();
            updateCharts();
            updateAchievementsDisplay();
            applyTheme();
        }
        
        // Load settings from localStorage
        function loadSettings() {
            const savedSettings = localStorage.getItem('cyclingCalculatorSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                currentUnit = settings.unit || 'kg';
                currentDistanceUnit = settings.distanceUnit || 'km';
                currentTheme = settings.theme || 'blue';
                notificationsEnabled = settings.notifications !== undefined ? settings.notifications : true;
                weeklyGoal = settings.weeklyGoal || 2000;
                
                notificationsToggle.checked = notificationsEnabled;
                weeklyGoalInput.value = weeklyGoal;
                
                // Update unit buttons
                unitButtons.forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.unit === currentUnit) {
                        btn.classList.add('active');
                    }
                });
                
                distanceUnitButtons.forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.distanceUnit === currentDistanceUnit) {
                        btn.classList.add('active');
                    }
                });
                
                // Update theme buttons
                themeButtons.forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.theme === currentTheme) {
                        btn.classList.add('active');
                    }
                });
            }
        }
        
        // Save settings to localStorage
        function saveSettings() {
            const settings = {
                unit: currentUnit,
                distanceUnit: currentDistanceUnit,
                theme: currentTheme,
                notifications: notificationsEnabled,
                weeklyGoal: parseInt(weeklyGoalInput.value) || 2000
            };
            localStorage.setItem('cyclingCalculatorSettings', JSON.stringify(settings));
        }
        
        // Load workouts from localStorage
        function loadWorkouts() {
            const savedWorkouts = localStorage.getItem('cyclingWorkouts');
            if (savedWorkouts) {
                workouts = JSON.parse(savedWorkouts);
            }
        }
        
        // Save workouts to localStorage
        function saveWorkouts() {
            localStorage.setItem('cyclingWorkouts', JSON.stringify(workouts));
        }
        
        // Load stats from localStorage
        function loadStats() {
            const savedStats = localStorage.getItem('cyclingStats');
            if (savedStats) {
                stats = JSON.parse(savedStats);
            }
        }
        
        // Save stats to localStorage
        function saveStats() {
            localStorage.setItem('cyclingStats', JSON.stringify(stats));
        }
        
        // Load achievements from localStorage
        function loadAchievements() {
            const savedAchievements = localStorage.getItem('cyclingAchievements');
            if (savedAchievements) {
                achievements = JSON.parse(savedAchievements);
            }
        }
        
        // Save achievements to localStorage
        function saveAchievements() {
            localStorage.setItem('cyclingAchievements', JSON.stringify(achievements));
        }
        
        // Calculate calories burned
        function calculateCalories() {
            const weight = parseFloat(weightInput.value);
            const duration = parseFloat(durationInput.value);
            const cyclingType = cyclingTypeInput.value;
            const intensity = parseFloat(intensitySelect.value);
            const terrain = parseFloat(terrainSelect.value);
            const weather = parseFloat(weatherSelect.value);
            
            if (!weight || !duration) {
                showNotification('Please enter weight and duration', 'error');
                return;
            }
            
            // Convert weight to kg if in lbs
            const weightKg = currentUnit === 'kg' ? weight : weight * 0.453592;
            
            // Get MET value for cycling type
            const met = cyclingMETs[cyclingType] || 4.0;
            
            // Calculate base calories burned: MET × weight (kg) × time (hours)
            let calories = met * weightKg * (duration / 60);
            
            // Apply modifiers
            calories *= intensity;
            calories *= terrain;
            calories *= weather;
            
            // Update result display
            caloriesResult.textContent = Math.round(calories);
            caloriesResult.classList.add('flip');
            setTimeout(() => caloriesResult.classList.remove('flip'), 600);
            
            // Update progress circle
            const progressPercent = Math.min(100, Math.round((calories / (weeklyGoal / 7)) * 100));
            const circumference = 2 * Math.PI * 50;
            const offset = circumference - (progressPercent / 100) * circumference;
            progressCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            progressCircle.style.strokeDashoffset = offset;
            progressText.textContent = `${progressPercent}%`;
            
            // Update description
            const typeNames = {
                leisure: 'Leisure Cycling',
                moderate: 'Moderate Cycling',
                vigorous: 'Vigorous Cycling',
                racing: 'Racing Cycling'
            };
            
            caloriesDescription.textContent = `${typeNames[cyclingType]} for ${duration} minutes`;
        }
        
        // Save workout
        function saveWorkout() {
            const weight = parseFloat(weightInput.value);
            const duration = parseFloat(durationInput.value);
            const distance = parseFloat(distanceInput.value);
            const cyclingType = cyclingTypeInput.value;
            
            if (!weight || !duration) {
                showNotification('Please calculate calories first', 'error');
                return;
            }
            
            const calories = parseInt(caloriesResult.textContent);
            
            const workout = {
                id: Date.now(),
                date: new Date().toISOString(),
                weight: weight,
                unit: currentUnit,
                cyclingType: cyclingType,
                duration: duration,
                distance: distance || 0,
                distanceUnit: currentDistanceUnit,
                calories: calories,
                intensity: intensitySelect.value,
                terrain: terrainSelect.value,
                weather: weatherSelect.value
            };
            
            workouts.push(workout);
            saveWorkouts();
            
            // Update stats
            stats.totalCalories += calories;
            stats.totalWorkouts++;
            stats.totalTime += duration;
            stats.totalDistance += distance || 0;
            stats.bestWorkout = Math.max(stats.bestWorkout, calories);
            
            saveStats();
            updateStatsDisplay();
            updateWorkoutList();
            updateCharts();
            checkAchievements();
            
            showNotification('Workout saved successfully!', 'success');
        }
        
        // Update stats display
        function updateStatsDisplay() {
            totalCaloriesEl.textContent = stats.totalCalories;
            totalWorkoutsEl.textContent = stats.totalWorkouts;
            totalTimeEl.textContent = stats.totalTime;
            bestWorkoutEl.textContent = stats.bestWorkout;
            totalDistanceEl.textContent = stats.totalDistance;
            
            const avgCalories = stats.totalWorkouts > 0 ? Math.round(stats.totalCalories / stats.totalWorkouts) : 0;
            avgCaloriesEl.textContent = avgCalories;
        }
        
        // Update workout list
        function updateWorkoutList() {
            let filteredWorkouts = [...workouts];
            
            // Apply search filter
            const searchTerm = searchWorkouts.value.toLowerCase();
            if (searchTerm) {
                filteredWorkouts = filteredWorkouts.filter(workout => 
                    workout.cyclingType.toLowerCase().includes(searchTerm)
                );
            }
            
            // Apply filter
            const filterValue = filterWorkouts.value;
            const now = new Date();
            if (filterValue === 'last7') {
                const sevenDaysAgo = new Date(now.setDate(now.getDate() - 7));
                filteredWorkouts = filteredWorkouts.filter(workout => 
                    new Date(workout.date) > sevenDaysAgo
                );
            } else if (filterValue === 'last30') {
                const thirtyDaysAgo = new Date(now.setDate(now.getDate() - 30));
                filteredWorkouts = filteredWorkouts.filter(workout => 
                    new Date(workout.date) > thirtyDaysAgo
                );
            } else if (filterValue === 'high-cal') {
                filteredWorkouts = filteredWorkouts.filter(workout => workout.calories > 300);
            }
            
            // Apply sorting
            const sortValue = sortWorkouts.value;
            filteredWorkouts.sort((a, b) => {
                switch(sortValue) {
                    case 'calories':
                        return b.calories - a.calories;
                    case 'duration':
                        return b.duration - a.duration;
                    case 'distance':
                        return (b.distance || 0) - (a.distance || 0);
                    default: // date
                        return new Date(b.date) - new Date(a.date);
                }
            });
            
            if (filteredWorkouts.length === 0) {
                workoutList.innerHTML = '<li class="workout-item">No workouts found</li>';
                return;
            }
            
            workoutList.innerHTML = '';
            filteredWorkouts.forEach(workout => {
                const li = document.createElement('li');
                li.className = 'workout-item';
                
                const typeNames = {
                    leisure: 'Leisure',
                    moderate: 'Moderate',
                    vigorous: 'Vigorous',
                    racing: 'Racing'
                };
                
                const distanceDisplay = workout.distance ? 
                    `${workout.distance} ${workout.distanceUnit}` : 'N/A';
                
                li.innerHTML = `
                    <div class="workout-info">
                        <div class="workout-title">${typeNames[workout.cyclingType]} Cycling</div>
                        <div class="workout-date">${new Date(workout.date).toLocaleDateString()}</div>
                    </div>
                    <div class="workout-meta">
                        <span>${workout.calories} cal</span>
                        <span>${workout.duration} min</span>
                        <span>${distanceDisplay}</span>
                        <div class="workout-actions">
                            <button class="action-btn edit-btn" data-id="${workout.id}"><i class="fas fa-edit"></i></button>
                            <button class="action-btn delete-btn" data-id="${workout.id}"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                `;
                workoutList.appendChild(li);
            });
            
            // Add event listeners for edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const workoutId = parseInt(e.target.closest('.edit-btn').dataset.id);
                    editWorkout(workoutId);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const workoutId = parseInt(e.target.closest('.delete-btn').dataset.id);
                    deleteWorkout(workoutId);
                });
            });
        }
        
        // Edit workout
        function editWorkout(workoutId) {
            const workout = workouts.find(w => w.id === workoutId);
            if (!workout) return;
            
            // Populate form with workout data
            weightInput.value = workout.weight;
            cyclingTypeInput.value = workout.cyclingType;
            durationInput.value = workout.duration;
            distanceInput.value = workout.distance || '';
            intensitySelect.value = workout.intensity;
            terrainSelect.value = workout.terrain;
            weatherSelect.value = workout.weather;
            
            // Update cycling type active state
            cyclingTypes.forEach(type => {
                type.classList.remove('active');
                if (type.dataset.type === workout.cyclingType) {
                    type.classList.add('active');
                }
            });
            
            // Calculate calories with the loaded data
            calculateCalories();
            
            showNotification('Workout data loaded for editing', 'success');
        }
        
        // Delete workout
        function deleteWorkout(workoutId) {
            if (confirm('Are you sure you want to delete this workout?')) {
                const workoutIndex = workouts.findIndex(w => w.id === workoutId);
                if (workoutIndex !== -1) {
                    const workout = workouts[workoutIndex];
                    stats.totalCalories -= workout.calories;
                    stats.totalWorkouts--;
                    stats.totalTime -= workout.duration;
                    stats.totalDistance -= workout.distance || 0;
                    
                    // Recalculate best workout
                    if (workout.calories === stats.bestWorkout) {
                        stats.bestWorkout = workouts
                            .filter(w => w.id !== workoutId)
                            .reduce((max, w) => Math.max(max, w.calories), 0);
                    }
                    
                    workouts.splice(workoutIndex, 1);
                    saveWorkouts();
                    saveStats();
                    updateStatsDisplay();
                    updateWorkoutList();
                    updateCharts();
                    showNotification('Workout deleted successfully!', 'success');
                }
            }
        }
        
        // Update charts
        function updateCharts() {
            // Weekly chart (last 7 days)
            const weeklyData = getWeeklyData();
            renderChart(weeklyChart, weeklyData, 'Calories');
            
            // Calories chart for analytics
            renderChart(caloriesChart, weeklyData, 'Calories');
            
            // Type chart
            const typeData = getTypeData();
            renderChart(typeChart, typeData, 'Workouts');
            
            // Monthly chart
            const monthlyData = getMonthlyData();
            renderChart(monthlyChart, monthlyData, 'Calories');
        }
        
        // Get weekly data
        function getWeeklyData() {
            const data = [];
            const now = new Date();
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(now);
                date.setDate(date.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];
                const dayName = date.toLocaleDateString('en-US', { weekday: 'short' });
                
                const calories = workouts
                    .filter(workout => workout.date.startsWith(dateStr))
                    .reduce((sum, workout) => sum + workout.calories, 0);
                
                data.push({ label: dayName, value: calories });
            }
            
            return data;
        }
        
        // Get type data
        function getTypeData() {
            const typeCounts = {
                leisure: 0,
                moderate: 0,
                vigorous: 0,
                racing: 0
            };
            
            workouts.forEach(workout => {
                typeCounts[workout.cyclingType] = (typeCounts[workout.cyclingType] || 0) + 1;
            });
            
            return Object.entries(typeCounts).map(([label, value]) => ({ 
                label: label.charAt(0).toUpperCase() + label.slice(1), 
                value 
            }));
        }
        
        // Get monthly data
        function getMonthlyData() {
            const data = [];
            const now = new Date();
            
            for (let i = 5; i >= 0; i--) {
                const date = new Date(now.getFullYear(), now.getMonth() - i, 1);
                const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
                const monthName = date.toLocaleString('default', { month: 'short' });
                
                const calories = workouts
                    .filter(workout => {
                        const workoutDate = new Date(workout.date);
                        const workoutMonthKey = `${workoutDate.getFullYear()}-${String(workoutDate.getMonth() + 1).padStart(2, '0')}`;
                        return workoutMonthKey === monthKey;
                    })
                    .reduce((sum, workout) => sum + workout.calories, 0);
                
                data.push({ label: monthName, value: calories });
            }
            
            return data;
        }
        
        // Render chart
        function renderChart(container, data, unit) {
            container.innerHTML = '';
            
            if (data.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #6c757d; padding: 20px;">No data available</div>';
                return;
            }
            
            const maxValue = Math.max(...data.map(item => item.value), 1);
            
            data.forEach(item => {
                const barHeight = maxValue > 0 ? (item.value / maxValue) * 100 : 0;
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = `${barHeight}%`;
                bar.innerHTML = `
                    <div class="chart-bar-value">${item.value}</div>
                    <div class="chart-bar-label">${item.label}</div>
                `;
                container.appendChild(bar);
            });
        }
        
        // Update achievements display
        function updateAchievementsDisplay() {
            achievementsList.innerHTML = '';
            
            achievements.forEach(achievement => {
                const div = document.createElement('div');
                div.className = 'achievement-card';
                div.style.background = achievement.unlocked ? 
                    'linear-gradient(135deg, #ffd166 0%, #ffb700 100%)' : 
                    'linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%)';
                div.style.color = achievement.unlocked ? '#333' : '#6c757d';
                div.innerHTML = `
                    <i class="${achievement.icon}"></i>
                    <h3>${achievement.name}</h3>
                    <p>${achievement.description}</p>
                    <div style="font-size: 0.9rem; margin-top: 10px;">
                        ${achievement.unlocked ? '✅ Unlocked' : '🔒 Locked'}
                    </div>
                `;
                achievementsList.appendChild(div);
            });
        }
        
        // Check for new achievements
        function checkAchievements() {
            let newAchievement = false;
            
            // First Ride
            if (!achievements[0].unlocked && stats.totalWorkouts >= 1) {
                achievements[0].unlocked = true;
                newAchievement = true;
            }
            
            // Calorie Crusher
            if (!achievements[1].unlocked && workouts.some(w => w.calories >= 500)) {
                achievements[1].unlocked = true;
                newAchievement = true;
            }
            
            // Week Warrior
            const oneWeekAgo = new Date();
            oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
            const weekWorkouts = workouts.filter(w => new Date(w.date) > oneWeekAgo);
            if (!achievements[2].unlocked && weekWorkouts.length >= 5) {
                achievements[2].unlocked = true;
                newAchievement = true;
            }
            
            // Distance Master
            if (!achievements[3].unlocked && stats.totalDistance >= 50) {
                achievements[3].unlocked = true;
                newAchievement = true;
            }
            
            // Marathon Cyclist
            if (!achievements[4].unlocked && workouts.some(w => w.duration >= 60)) {
                achievements[4].unlocked = true;
                newAchievement = true;
            }
            
            // Consistency King
            // This would require tracking consecutive days - simplified for now
            
            // Calorie Champion
            if (!achievements[6].unlocked && stats.totalCalories >= 5000) {
                achievements[6].unlocked = true;
                newAchievement = true;
            }
            
            // Mountain Climber
            if (!achievements[7].unlocked && workouts.some(w => w.terrain == 1.8)) {
                achievements[7].unlocked = true;
                newAchievement = true;
            }
            
            if (newAchievement) {
                saveAchievements();
                updateAchievementsDisplay();
                showNotification('🎉 New achievement unlocked!', 'success');
            }
        }
        
        // Clear all data
        function clearData() {
            if (confirm('Are you sure you want to clear all cycling data? This cannot be undone.')) {
                localStorage.removeItem('cyclingWorkouts');
                localStorage.removeItem('cyclingStats');
                localStorage.removeItem('cyclingAchievements');
                localStorage.removeItem('cyclingCalculatorSettings');
                
                workouts = [];
                stats = {
                    totalCalories: 0,
                    totalWorkouts: 0,
                    totalTime: 0,
                    bestWorkout: 0,
                    totalDistance: 0
                };
                
                achievements = [
                    { id: 1, name: "First Ride", description: "Complete your first cycling workout", unlocked: false, icon: "fas fa-bicycle" },
                    { id: 2, name: "Calorie Crusher", description: "Burn 500 calories in a single workout", unlocked: false, icon: "fas fa-fire" },
                    { id: 3, name: "Week Warrior", description: "Complete 5 workouts in a week", unlocked: false, icon: "fas fa-calendar-week" },
                    { id: 4, name: "Distance Master", description: "Cycle 50km in total", unlocked: false, icon: "fas fa-route" },
                    { id: 5, name: "Marathon Cyclist", description: "Cycle for 60 minutes straight", unlocked: false, icon: "fas fa-hourglass-half" },
                    { id: 6, name: "Consistency King", description: "Cycle for 30 days straight", unlocked: false, icon: "fas fa-crown" },
                    { id: 7, name: "Calorie Champion", description: "Burn 5000 calories in total", unlocked: false, icon: "fas fa-trophy" },
                    { id: 8, name: "Mountain Climber", description: "Cycle on mountainous terrain", unlocked: false, icon: "fas fa-mountain" }
                ];
                
                currentUnit = 'kg';
                currentDistanceUnit = 'km';
                currentTheme = 'blue';
                notificationsEnabled = true;
                weeklyGoal = 2000;
                
                updateStatsDisplay();
                updateWorkoutList();
                updateCharts();
                updateAchievementsDisplay();
                applyTheme();
                showNotification('All data cleared successfully!', 'success');
            }
        }
        
        // Export data
        function exportData() {
            const dataStr = JSON.stringify({
                workouts: workouts,
                stats: stats,
                achievements: achievements,
                settings: {
                    unit: currentUnit,
                    distanceUnit: currentDistanceUnit,
                    theme: currentTheme,
                    notifications: notificationsEnabled,
                    weeklyGoal: weeklyGoal
                }
            }, null, 2);
            
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'cycling-calculator-data.json';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showNotification('Data exported successfully!', 'success');
        }
        
        // Import data
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = e => {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(event) {
                    try {
                        const data = JSON.parse(event.target.result);
                        
                        // Restore data
                        if (data.workouts) workouts = data.workouts;
                        if (data.stats) stats = data.stats;
                        if (data.achievements) achievements = data.achievements;
                        if (data.settings) {
                            currentUnit = data.settings.unit || 'kg';
                            currentDistanceUnit = data.settings.distanceUnit || 'km';
                            currentTheme = data.settings.theme || 'blue';
                            notificationsEnabled = data.settings.notifications !== undefined ? data.settings.notifications : true;
                            weeklyGoal = data.settings.weeklyGoal || 2000;
                        }
                        
                        // Save to localStorage
                        saveWorkouts();
                        saveStats();
                        saveAchievements();
                        saveSettings();
                        
                        // Update UI
                        updateStatsDisplay();
                        updateWorkoutList();
                        updateCharts();
                        updateAchievementsDisplay();
                        applyTheme();
                        
                        showNotification('Data imported successfully!', 'success');
                    } catch (error) {
                        showNotification('Error importing data. Please check the file format.', 'error');
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // Apply theme
        function applyTheme() {
            const theme = themes[currentTheme];
            document.documentElement.style.setProperty('--primary', theme.primary);
            document.documentElement.style.setProperty('--secondary', theme.secondary);
        }
        
        // Change theme
        function changeTheme(themeName) {
            currentTheme = themeName;
            applyTheme();
            
            // Update active state
            themeButtons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Save theme preference
            saveSettings();
            showNotification('Theme updated!', 'success');
        }
        
        // Change unit
        function changeUnit(unit) {
            currentUnit = unit;
            
            // Update active state
            unitButtons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Save unit preference
            saveSettings();
            showNotification(`Weight unit changed to ${unit}`, 'success');
            
            // Recalculate if values exist
            if (weightInput.value && durationInput.value) {
                calculateCalories();
            }
        }
        
        // Change distance unit
        function changeDistanceUnit(unit) {
            currentDistanceUnit = unit;
            distanceUnitInput.value = unit;
            
            // Update active state
            distanceUnitButtons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Save unit preference
            saveSettings();
            showNotification(`Distance unit changed to ${unit}`, 'success');
        }
        
        // Change cycling type
        function changeCyclingType(type) {
            cyclingTypeInput.value = type;
            
            // Update active state
            cyclingTypes.forEach(cyclingType => cyclingType.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update calculation
            calculateCalories();
        }
        
        // Show notification
        function showNotification(message, type) {
            if (!notificationsEnabled) return;
            
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                ${message}
            `;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Hide modals
        function hideModals() {
            chartsModal.classList.add('hidden');
            achievementsModal.classList.add('hidden');
        }
        
        // Event Listeners
        calculateBtn.addEventListener('click', calculateCalories);
        saveWorkoutBtn.addEventListener('click', saveWorkout);
        chartsBtn.addEventListener('click', () => {
            updateCharts();
            chartsModal.classList.remove('hidden');
        });
        achievementsBtn.addEventListener('click', () => {
            updateAchievementsDisplay();
            achievementsModal.classList.remove('hidden');
        });
        clearDataBtn.addEventListener('click', clearData);
        exportDataBtn.addEventListener('click', exportData);
        importDataBtn.addEventListener('click', importData);
        closeChartsBtn.addEventListener('click', hideModals);
        closeAchievementsBtn.addEventListener('click', hideModals);
        
        // Unit buttons
        unitButtons.forEach(btn => {
            btn.addEventListener('click', () => changeUnit(btn.dataset.unit));
        });
        
        distanceUnitButtons.forEach(btn => {
            btn.addEventListener('click', () => changeDistanceUnit(btn.dataset.distanceUnit));
        });
        
        // Cycling type buttons
        cyclingTypes.forEach(type => {
            type.addEventListener('click', () => changeCyclingType(type.dataset.type));
        });
        
        // Theme buttons
        themeButtons.forEach(btn => {
            btn.addEventListener('click', () => changeTheme(btn.dataset.theme));
        });
        
        // Settings events
        notificationsToggle.addEventListener('change', () => {
            notificationsEnabled = notificationsToggle.checked;
            saveSettings();
        });
        
        weeklyGoalInput.addEventListener('change', saveSettings);
        
        // Input validation and auto-calculation
        weightInput.addEventListener('input', () => {
            if (weightInput.value && durationInput.value) {
                calculateCalories();
            }
        });
        
        durationInput.addEventListener('input', () => {
            if (weightInput.value && durationInput.value) {
                calculateCalories();
            }
        });
        
        distanceInput.addEventListener('input', () => {
            if (weightInput.value && durationInput.value) {
                calculateCalories();
            }
        });
        
        intensitySelect.addEventListener('change', calculateCalories);
        terrainSelect.addEventListener('change', calculateCalories);
        weatherSelect.addEventListener('change', calculateCalories);
        
        // Search and filter events
        searchWorkouts.addEventListener('input', updateWorkoutList);
        sortWorkouts.addEventListener('change', updateWorkoutList);
        filterWorkouts.addEventListener('change', updateWorkoutList);
        
        // Close modals when clicking outside
        document.addEventListener('click', (e) => {
            if (e.target === chartsModal || e.target === achievementsModal) {
                hideModals();
            }
        });
        
        // Initialize app
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
