<!-- Category: Utility -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AC Filter Replacement Reminder</title>
    <!-- Favicon using a data URI to keep it a single file -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>❄️</text></svg>">
    <style>
        :root {
            --color-good: #2ecc71;
            --color-soon: #f1c40f;
            --color-overdue: #e74c3c;
            --color-primary: #3498db;
            --color-dark: #2c3e50;
            --color-light: #ecf0f1;
            --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --radius: 12px;
            --shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: var(--font-family);
            background-color: var(--color-light);
            color: var(--color-dark);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .container {
            width: 100%;
            max-width: 420px;
            background: #ffffff;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 30px;
            text-align: center;
        }

        header h1 {
            color: var(--color-dark);
            margin: 0 0 5px 0;
        }

        header p {
            color: #7f8c8d;
            margin: 0 0 25px 0;
            font-size: 0.9rem;
        }

        .status-circle-container {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 20px auto;
        }

        .status-circle-svg {
            transform: rotate(-90deg);
        }
        
        .circle-bg, .circle-progress {
            fill: none;
            stroke-width: 15;
        }

        .circle-bg { stroke: #e6e6e6; }
        .circle-progress {
            stroke: var(--color-primary);
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease, stroke 0.5s ease;
        }

        .status-text-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        #days-remaining {
            font-size: 3.5rem;
            font-weight: bold;
            margin: 0;
        }

        #days-label {
            font-size: 1rem;
            color: #7f8c8d;
            margin: 0;
        }

        #status-message {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 10px 0 5px 0;
        }
        #due-date-text {
            font-size: 1rem;
            color: #7f8c8d;
            margin: 0 0 25px 0;
        }

        #reset-button {
            width: 100%;
            padding: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            color: white;
            background-color: var(--color-primary);
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            transition: background-color 0.2s;
        }
        #reset-button:hover { background-color: #2980b9; }

        .details-section { margin-top: 30px; text-align: left; }
        .details-section h2 {
            font-size: 1rem;
            color: #7f8c8d;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
        }

        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-weight: bold; margin-bottom: 5px; }
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
        }
        
        #history-list {
            list-style-type: none;
            padding: 0;
            max-height: 150px;
            overflow-y: auto;
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 10px;
        }
        #history-list li {
            padding: 8px;
            border-bottom: 1px solid #eee;
        }
        #history-list li:last-child { border-bottom: none; }
        
        #clear-data-btn {
            background: none; border: none; color: var(--color-overdue);
            cursor: pointer; text-decoration: underline; margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>AC Filter Reminder</h1>
            <p>Your data is saved on this device and is 100% private.</p>
        </header>

        <main>
            <div class="status-circle-container">
                <svg class="status-circle-svg" width="200" height="200" viewBox="0 0 200 200">
                    <circle class="circle-bg" cx="100" cy="100" r="90"></circle>
                    <circle class="circle-progress" id="circle-progress" cx="100" cy="100" r="90"></circle>
                </svg>
                <div class="status-text-overlay">
                    <h2 id="days-remaining">...</h2>
                    <p id="days-label">days left</p>
                </div>
            </div>

            <h2 id="status-message">Loading...</h2>
            <p id="due-date-text">Next due date will appear here.</p>

            <button id="reset-button">I Just Replaced My Filter</button>
        </main>

        <div class="details-section">
            <h2>Settings</h2>
            <div class="form-group">
                <label for="last-replaced-date">Last Replaced Date</label>
                <input type="date" id="last-replaced-date">
            </div>
            <div class="form-group">
                <label for="replacement-interval">Replacement Interval</label>
                <select id="replacement-interval">
                    <option value="30">Every 30 Days (1 Month)</option>
                    <option value="60">Every 60 Days (2 Months)</option>
                    <option value="90" selected>Every 90 Days (3 Months)</option>
                    <option value="180">Every 180 Days (6 Months)</option>
                </select>
            </div>
        </div>
        
        <div class="details-section">
            <h2>History</h2>
            <ul id="history-list">
                <li>No history yet.</li>
            </ul>
        </div>
        
        <button id="clear-data-btn">Clear all data and start over</button>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const STORAGE_KEYS = {
            LAST_CHANGED: 'acFilter_lastChanged',
            INTERVAL: 'acFilter_interval',
            HISTORY: 'acFilter_history'
        };

        // --- DOM Elements ---
        const lastReplacedInput = document.getElementById('last-replaced-date');
        const intervalSelect = document.getElementById('replacement-interval');
        const resetButton = document.getElementById('reset-button');
        const clearButton = document.getElementById('clear-data-btn');
        
        const statusMessage = document.getElementById('status-message');
        const dueDateText = document.getElementById('due-date-text');
        const daysRemainingText = document.getElementById('days-remaining');
        const daysLabel = document.getElementById('days-label');
        const historyList = document.getElementById('history-list');
        
        const progressCircle = document.getElementById('circle-progress');
        const circleRadius = progressCircle.r.baseVal.value;
        const circumference = 2 * Math.PI * circleRadius;
        progressCircle.style.strokeDasharray = `${circumference} ${circumference}`;

        // --- Date Helper ---
        const toISODateString = (date) => {
            const y = date.getFullYear();
            const m = String(date.getMonth() + 1).padStart(2, '0');
            const d = String(date.getDate()).padStart(2, '0');
            return `${y}-${m}-${d}`;
        };

        // --- Core Logic ---
        function updateUI() {
            const lastChangedStr = lastReplacedInput.value;
            if (!lastChangedStr) {
                statusMessage.textContent = 'Setup Required';
                dueDateText.textContent = 'Please set your last replacement date.';
                return;
            }

            const intervalDays = parseInt(intervalSelect.value);
            const lastChangedDate = new Date(lastChangedStr + 'T00:00:00');
            const dueDate = new Date(lastChangedDate);
            dueDate.setDate(dueDate.getDate() + intervalDays);

            const today = new Date();
            today.setHours(0, 0, 0, 0); // Normalize to start of day

            const timeDiff = dueDate.getTime() - today.getTime();
            const daysRemaining = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));
            
            const daysPassed = intervalDays - daysRemaining;
            const progressPercent = Math.min(100, Math.max(0, (daysPassed / intervalDays) * 100));
            const offset = circumference - (progressPercent / 100) * circumference;
            progressCircle.style.strokeDashoffset = offset;

            dueDateText.textContent = `Next Due Date: ${dueDate.toLocaleDateString()}`;

            // Update colors and text based on status
            if (daysRemaining < 0) {
                statusMessage.textContent = 'OVERDUE!';
                statusMessage.style.color = 'var(--color-overdue)';
                progressCircle.style.stroke = 'var(--color-overdue)';
                daysRemainingText.style.color = 'var(--color-overdue)';
                daysRemainingText.textContent = Math.abs(daysRemaining);
                daysLabel.textContent = 'days overdue';
            } else if (daysRemaining <= 7) {
                statusMessage.textContent = 'Due Soon';
                statusMessage.style.color = 'var(--color-soon)';
                progressCircle.style.stroke = 'var(--color-soon)';
                daysRemainingText.style.color = 'var(--color-soon)';
                daysRemainingText.textContent = daysRemaining;
                daysLabel.textContent = 'days left';
            } else {
                statusMessage.textContent = 'All Good!';
                statusMessage.style.color = 'var(--color-good)';
                progressCircle.style.stroke = 'var(--color-good)';
                daysRemainingText.style.color = 'var(--color-good)';
                daysRemainingText.textContent = daysRemaining;
                daysLabel.textContent = 'days left';
            }
        }

        function updateHistoryList() {
            const history = JSON.parse(localStorage.getItem(STORAGE_KEYS.HISTORY) || '[]');
            historyList.innerHTML = '';
            if (history.length === 0) {
                historyList.innerHTML = '<li>No history yet.</li>';
            } else {
                history.slice().reverse().forEach(dateStr => { // Show most recent first
                    const li = document.createElement('li');
                    li.textContent = `Replaced on ${new Date(dateStr).toLocaleDateString()}`;
                    historyList.appendChild(li);
                });
            }
        }

        // --- Data Persistence ---
        function saveData() {
            localStorage.setItem(STORAGE_KEYS.LAST_CHANGED, lastReplacedInput.value);
            localStorage.setItem(STORAGE_KEYS.INTERVAL, intervalSelect.value);
            updateUI();
        }

        function loadData() {
            const savedDate = localStorage.getItem(STORAGE_KEYS.LAST_CHANGED);
            const savedInterval = localStorage.getItem(STORAGE_KEYS.INTERVAL);

            lastReplacedInput.value = savedDate || toISODateString(new Date());
            intervalSelect.value = savedInterval || '90';

            updateHistoryList();
            updateUI();
        }
        
        // --- Event Handlers ---
        resetButton.addEventListener('click', () => {
            if (!lastReplacedInput.value) {
                alert("Please set an initial date first.");
                return;
            }
            // Add old date to history
            const history = JSON.parse(localStorage.getItem(STORAGE_KEYS.HISTORY) || '[]');
            history.push(lastReplacedInput.value);
            localStorage.setItem(STORAGE_KEYS.HISTORY, JSON.stringify(history));

            // Set new date to today
            lastReplacedInput.value = toISODateString(new Date());
            
            saveData();
            updateHistoryList();
            
            // Visual feedback
            resetButton.textContent = 'Done! See you next time.';
            resetButton.style.backgroundColor = 'var(--color-good)';
            setTimeout(() => {
                resetButton.textContent = 'I Just Replaced My Filter';
                resetButton.style.backgroundColor = 'var(--color-primary)';
            }, 2000);
        });

        clearButton.addEventListener('click', () => {
            if (confirm('Are you sure you want to clear all your data? This cannot be undone.')) {
                localStorage.removeItem(STORAGE_KEYS.LAST_CHANGED);
                localStorage.removeItem(STORAGE_KEYS.INTERVAL);
                localStorage.removeItem(STORAGE_KEYS.HISTORY);
                window.location.reload();
            }
        });

        lastReplacedInput.addEventListener('change', saveData);
        intervalSelect.addEventListener('change', saveData);

        // --- Initial Load ---
        loadData();
    });
    </script>
</body>
</html>
