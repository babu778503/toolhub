<!DOCTYPE html>
<!-- Category: Entertainment & Events -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stage Lighting Planner</title>
    <meta name="description" content="Plan your stage lighting with our interactive lighting designer. Perfect for theaters, concerts, and events.">
    <meta name="keywords" content="stage lighting planner, lighting design, stage lighting, lighting designer, concert lighting, theater lighting, event lighting">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #6a11cb;
            --secondary: #2575fc;
            --accent: #ff2d75;
            --dark: #121212;
            --light: #f5f5f5;
            --gray: #2a2a2a;
            --stage-bg: #1e1e2e;
            --light-color: #ffcc00;
            --spotlight-color: #00ccff;
            --wash-color: #ff6b6b;
            --backlight-color: #6b5b95;
            --uplight-color: #4ecdc4;
            --gobo-color: #ff9f1c;
            --color1: #ffcc00;
            --color2: #00ccff;
            --color3: #ff6b6b;
            --color4: #6b5b95;
            --color5: #4ecdc4;
            --color6: #ff9f1c;
            --color7: #e71d36;
            --color8: #2ec4b6;
        }

        body {
            background: linear-gradient(135deg, var(--dark), #1a1a2e);
            color: var(--light);
            min-height: 100vh;
            padding: 0;
            margin: 0;
        }

        /* Fixed header with tool name */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 50px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 1px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .container {
            max-width: 100%;
            margin: 0;
            padding: 0;
        }

        /* Main content */
        .content {
            background: rgba(30, 30, 40, 0.7);
            border-radius: 0;
            padding: 20px 15px;
            margin-top: 50px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Stage visualization */
        .stage-container {
            position: relative;
            width: 100%;
            height: 400px;
            background: var(--stage-bg);
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .stage {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #2c2c3e, #1e1e2e);
        }

        .stage-border {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }

        .stage-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            height: 60%;
            border: 1px dashed rgba(255, 255, 255, 0.1);
        }

        .light {
            position: absolute;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 15px currentColor;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .light:hover {
            transform: scale(1.2);
        }

        .light.selected {
            border: 3px solid white;
            box-shadow: 0 0 25px currentColor;
        }

        .light-type {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            background: rgba(0, 0, 0, 0.7);
            padding: 2px 5px;
            border-radius: 3px;
            white-space: nowrap;
        }

        /* Controls */
        .controls {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin: 25px 0;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            color: #bbb;
            font-size: 0.9rem;
        }

        .control-value {
            color: var(--accent);
            font-weight: 600;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        input[type="range"] {
            flex: 1;
            height: 8px;
            border-radius: 4px;
            background: var(--gray);
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            box-shadow: 0 0 8px rgba(255, 45, 117, 0.5);
        }

        /* Light types */
        .light-types {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .light-type-btn {
            padding: 10px 15px;
            border-radius: 8px;
            border: none;
            background: rgba(70, 70, 90, 0.7);
            color: #ddd;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .light-type-btn.active {
            background: var(--accent);
            color: white;
        }

        .light-type-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }

        /* Color picker */
        .color-picker {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s ease;
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .color-option.active {
            border-color: white;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
        }

        /* Scene controls */
        .scenes {
            margin: 25px 0;
            padding: 15px;
            background: rgba(40, 40, 55, 0.5);
            border-radius: 10px;
        }

        .scene-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--accent);
            text-align: center;
        }

        .scene-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .scene-btn {
            padding: 8px 15px;
            background: rgba(70, 70, 90, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            color: #ddd;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .scene-btn:hover {
            background: rgba(100, 100, 130, 0.7);
        }

        .scene-btn.active {
            background: var(--calm-color);
            color: white;
        }

        /* Presets */
        .presets {
            margin: 25px 0;
            padding: 15px;
            background: rgba(40, 40, 55, 0.5);
            border-radius: 10px;
        }

        .preset-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
            justify-content: center;
        }

        .preset-btn {
            padding: 8px 15px;
            background: rgba(70, 70, 90, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            color: #ddd;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .preset-btn:hover {
            background: rgba(100, 100, 130, 0.7);
        }

        .preset-btn.active {
            background: var(--accent);
            color: white;
        }

        /* Light groups */
        .light-groups {
            margin: 25px 0;
            padding: 15px;
            background: rgba(40, 40, 55, 0.5);
            border-radius: 10px;
        }

        .group-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--accent);
            text-align: center;
        }

        .group-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .group-item {
            padding: 8px 15px;
            background: rgba(70, 70, 90, 0.7);
            border-radius: 20px;
            color: #ddd;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .group-item:hover {
            background: rgba(100, 100, 130, 0.7);
        }

        .group-item.active {
            background: var(--uplight-color);
            color: white;
        }

        /* Buttons */
        .buttons {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        button {
            padding: 14px 20px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            font-size: 1rem;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        button:active {
            transform: translateY(1px);
        }

        .add-btn {
            background: linear-gradient(to right, #00b09b, #96c93d);
        }

        .delete-btn {
            background: linear-gradient(to right, #ff416c, #ff4b2b);
        }

        .clear-btn {
            background: linear-gradient(to right, #4b6cb7, #182848);
        }

        .preview-btn {
            background: linear-gradient(to right, #ff9a00, #ff6a00);
        }

        /* Mobile-specific adjustments */
        @media (max-width: 480px) {
            .header {
                height: 50px;
            }
            
            .content {
                padding: 15px 10px;
                margin-top: 50px;
            }
            
            .stage-container {
                height: 300px;
            }
            
            .controls {
                gap: 15px;
            }
            
            .control-label {
                font-size: 0.85rem;
            }
            
            .slider-container {
                gap: 5px;
            }
            
            .buttons {
                grid-template-columns: 1fr;
            }
            
            .light-types {
                gap: 10px;
            }
            
            .light-type-btn {
                padding: 8px 12px;
                font-size: 0.9rem;
            }
            
            .color-option {
                width: 35px;
                height: 35px;
            }
            
            .scene-buttons {
                justify-content: center;
            }
            
            .preset-buttons {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Fixed header with tool name -->
    <div class="header">
        <h1>Stage Lighting Planner</h1>
    </div>

    <div class="container">
        <div class="content">
            <div class="stage-container">
                <div class="stage">
                    <div class="stage-border"></div>
                    <div class="stage-center"></div>
                    <!-- Lights will be added here dynamically -->
                </div>
            </div>
            
            <div class="light-types">
                <button class="light-type-btn active" data-type="spotlight">
                    <div class="light-type-color" style="background-color: var(--spotlight-color);"></div>
                    Spotlight
                </button>
                <button class="light-type-btn" data-type="wash">
                    <div class="light-type-color" style="background-color: var(--wash-color);"></div>
                    Wash
                </button>
                <button class="light-type-btn" data-type="backlight">
                    <div class="light-type-color" style="background-color: var(--backlight-color);"></div>
                    Backlight
                </button>
                <button class="light-type-btn" data-type="uplight">
                    <div class="light-type-color" style="background-color: var(--uplight-color);"></div>
                    Uplight
                </button>
                <button class="light-type-btn" data-type="gobo">
                    <div class="light-type-color" style="background-color: var(--gobo-color);"></div>
                    Gobo
                </button>
            </div>
            
            <div class="color-picker">
                <div class="color-option active" style="background-color: var(--color1);" data-color="var(--color1)"></div>
                <div class="color-option" style="background-color: var(--color2);" data-color="var(--color2)"></div>
                <div class="color-option" style="background-color: var(--color3);" data-color="var(--color3)"></div>
                <div class="color-option" style="background-color: var(--color4);" data-color="var(--color4)"></div>
                <div class="color-option" style="background-color: var(--color5);" data-color="var(--color5)"></div>
                <div class="color-option" style="background-color: var(--color6);" data-color="var(--color6)"></div>
                <div class="color-option" style="background-color: var(--color7);" data-color="var(--color7)"></div>
                <div class="color-option" style="background-color: var(--color8);" data-color="var(--color8)"></div>
            </div>
            
            <div class="controls">
                <div class="control-group">
                    <div class="control-label">
                        <span>Intensity</span>
                        <span class="control-value" id="intensity-value">70%</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" id="intensity" min="0" max="100" value="70">
                    </div>
                </div>
                
                <div class="control-group">
                    <div class="control-label">
                        <span>Beam Angle</span>
                        <span class="control-value" id="angle-value">30°</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" id="angle" min="10" max="90" value="30">
                    </div>
                </div>
                
                <div class="control-group">
                    <div class="control-label">
                        <span>Strobe Rate</span>
                        <span class="control-value" id="strobe-value">0%</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" id="strobe" min="0" max="100" value="0">
                    </div>
                </div>
            </div>
            
            <div class="scenes">
                <div class="scene-title">Scenes</div>
                <div class="scene-buttons">
                    <button class="scene-btn active" data-scene="main">Main</button>
                    <button class="scene-btn" data-scene="intro">Intro</button>
                    <button class="scene-btn" data-scene="verse">Verse</button>
                    <button class="scene-btn" data-scene="chorus">Chorus</button>
                    <button class="scene-btn" data-scene="bridge">Bridge</button>
                    <button class="scene-btn" data-scene="outro">Outro</button>
                </div>
            </div>
            
            <div class="presets">
                <div class="control-label">
                    <span>Presets</span>
                </div>
                <div class="preset-buttons">
                    <button class="preset-btn" data-preset="concert">Concert</button>
                    <button class="preset-btn" data-preset="theater">Theater</button>
                    <button class="preset-btn" data-preset="dance">Dance</button>
                    <button class="preset-btn" data-preset="intimate">Intimate</button>
                </div>
            </div>
            
            <div class="light-groups">
                <div class="group-title">Light Groups</div>
                <div class="group-list">
                    <div class="group-item active" data-group="all">All Lights</div>
                    <div class="group-item" data-group="front">Front</div>
                    <div class="group-item" data-group="back">Back</div>
                    <div class="group-item" data-group="sides">Sides</div>
                    <div class="group-item" data-group="center">Center</div>
                </div>
            </div>
            
            <div class="buttons">
                <button id="add-btn" class="add-btn">Add Light</button>
                <button id="delete-btn" class="delete-btn">Delete Selected</button>
                <button id="clear-btn" class="clear-btn">Clear All</button>
                <button id="preview-btn" class="preview-btn">Preview Scene</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // State management
            const state = {
                selectedLight: null,
                currentType: 'spotlight',
                currentColor: 'var(--color1)',
                intensity: 70,
                beamAngle: 30,
                strobeRate: 0,
                lights: [],
                scenes: {
                    main: [],
                    intro: [],
                    verse: [],
                    chorus: [],
                    bridge: [],
                    outro: []
                },
                currentScene: 'main',
                currentGroup: 'all',
                presets: {
                    concert: [
                        {x: 100, y: 100, type: 'spotlight', color: 'var(--color1)', intensity: 80, beamAngle: 25, strobeRate: 0},
                        {x: 300, y: 100, type: 'spotlight', color: 'var(--color2)', intensity: 80, beamAngle: 25, strobeRate: 0},
                        {x: 500, y: 100, type: 'spotlight', color: 'var(--color3)', intensity: 80, beamAngle: 25, strobeRate: 0},
                        {x: 200, y: 300, type: 'wash', color: 'var(--color4)', intensity: 60, beamAngle: 45, strobeRate: 0},
                        {x: 400, y: 300, type: 'wash', color: 'var(--color5)', intensity: 60, beamAngle: 45, strobeRate: 0}
                    ],
                    theater: [
                        {x: 200, y: 150, type: 'spotlight', color: 'var(--color1)', intensity: 90, beamAngle: 30, strobeRate: 0},
                        {x: 400, y: 150, type: 'spotlight', color: 'var(--color1)', intensity: 90, beamAngle: 30, strobeRate: 0},
                        {x: 300, y: 300, type: 'backlight', color: 'var(--color6)', intensity: 70, beamAngle: 60, strobeRate: 0},
                        {x: 100, y: 250, type: 'uplight', color: 'var(--color7)', intensity: 50, beamAngle: 40, strobeRate: 0},
                        {x: 500, y: 250, type: 'uplight', color: 'var(--color7)', intensity: 50, beamAngle: 40, strobeRate: 0}
                    ],
                    dance: [
                        {x: 150, y: 100, type: 'gobo', color: 'var(--color8)', intensity: 85, beamAngle: 20, strobeRate: 20},
                        {x: 450, y: 100, type: 'gobo', color: 'var(--color8)', intensity: 85, beamAngle: 20, strobeRate: 20},
                        {x: 100, y: 300, type: 'wash', color: 'var(--color3)', intensity: 75, beamAngle: 50, strobeRate: 10},
                        {x: 500, y: 300, type: 'wash', color: 'var(--color5)', intensity: 75, beamAngle: 50, strobeRate: 10},
                        {x: 300, y: 200, type: 'spotlight', color: 'var(--color1)', intensity: 90, beamAngle: 25, strobeRate: 0}
                    ],
                    intimate: [
                        {x: 300, y: 150, type: 'spotlight', color: 'var(--color1)', intensity: 85, beamAngle: 35, strobeRate: 0},
                        {x: 200, y: 300, type: 'wash', color: 'var(--color4)', intensity: 60, beamAngle: 50, strobeRate: 0},
                        {x: 400, y: 300, type: 'wash', color: 'var(--color4)', intensity: 60, beamAngle: 50, strobeRate: 0}
                    ]
                }
            };
            
            // DOM elements
            const stage = document.querySelector('.stage');
            const addBtn = document.getElementById('add-btn');
            const deleteBtn = document.getElementById('delete-btn');
            const clearBtn = document.getElementById('clear-btn');
            const previewBtn = document.getElementById('preview-btn');
            const intensitySlider = document.getElementById('intensity');
            const angleSlider = document.getElementById('angle');
            const strobeSlider = document.getElementById('strobe');
            const intensityValue = document.getElementById('intensity-value');
            const angleValue = document.getElementById('angle-value');
            const strobeValue = document.getElementById('strobe-value');
            const lightTypeButtons = document.querySelectorAll('.light-type-btn');
            const colorOptions = document.querySelectorAll('.color-option');
            const sceneButtons = document.querySelectorAll('.scene-btn');
            const presetButtons = document.querySelectorAll('.preset-btn');
            const groupItems = document.querySelectorAll('.group-item');
            
            // Initialize from saved data
            function loadState() {
                const savedState = localStorage.getItem('stageLightingState');
                if (savedState) {
                    const parsed = JSON.parse(savedState);
                    state.lights = parsed.lights || [];
                    state.scenes = parsed.scenes || state.scenes;
                    state.currentScene = parsed.currentScene || 'main';
                    state.currentType = parsed.currentType || 'spotlight';
                    state.currentColor = parsed.currentColor || 'var(--color1)';
                    state.intensity = parsed.intensity || 70;
                    state.beamAngle = parsed.beamAngle || 30;
                    state.strobeRate = parsed.strobeRate || 0;
                    
                    // Update UI
                    intensitySlider.value = state.intensity;
                    angleSlider.value = state.beamAngle;
                    strobeSlider.value = state.strobeRate;
                    intensityValue.textContent = `${state.intensity}%`;
                    angleValue.textContent = `${state.beamAngle}°`;
                    strobeValue.textContent = `${state.strobeRate}%`;
                    
                    // Update light type buttons
                    lightTypeButtons.forEach(btn => {
                        if (btn.dataset.type === state.currentType) {
                            btn.classList.add('active');
                        } else {
                            btn.classList.remove('active');
                        }
                    });
                    
                    // Update color options
                    colorOptions.forEach(option => {
                        if (option.dataset.color === state.currentColor) {
                            option.classList.add('active');
                        } else {
                            option.classList.remove('active');
                        }
                    });
                    
                    // Update scene buttons
                    sceneButtons.forEach(btn => {
                        if (btn.dataset.scene === state.currentScene) {
                            btn.classList.add('active');
                        } else {
                            btn.classList.remove('active');
                        }
                    });
                    
                    // Render lights
                    renderLights();
                }
            }
            
            // Save state to localStorage
            function saveState() {
                localStorage.setItem('stageLightingState', JSON.stringify({
                    lights: state.lights,
                    scenes: state.scenes,
                    currentScene: state.currentScene,
                    currentType: state.currentType,
                    currentColor: state.currentColor,
                    intensity: state.intensity,
                    beamAngle: state.beamAngle,
                    strobeRate: state.strobeRate
                }));
            }
            
            // Render lights on the stage
            function renderLights() {
                // Clear existing lights
                document.querySelectorAll('.light').forEach(light => light.remove());
                
                // Get lights for current scene
                const lightsToRender = state.scenes[state.currentScene] || state.lights;
                
                // Add lights to stage
                lightsToRender.forEach((light, index) => {
                    const lightEl = document.createElement('div');
                    lightEl.className = 'light';
                    lightEl.style.left = `${light.x}px`;
                    lightEl.style.top = `${light.y}px`;
                    lightEl.style.backgroundColor = light.color;
                    lightEl.style.boxShadow = `0 0 ${light.intensity / 2}px ${light.color}`;
                    lightEl.dataset.index = index;
                    
                    // Add light type label
                    const typeLabel = document.createElement('div');
                    typeLabel.className = 'light-type';
                    typeLabel.textContent = light.type;
                    lightEl.appendChild(typeLabel);
                    
                    // Add click event to select light
                    lightEl.addEventListener('click', (e) => {
                        e.stopPropagation();
                        selectLight(index);
                    });
                    
                    stage.appendChild(lightEl);
                });
            }
            
            // Select a light
            function selectLight(index) {
                // Remove selection from all lights
                document.querySelectorAll('.light').forEach(light => {
                    light.classList.remove('selected');
                });
                
                // Add selection to clicked light
                const lightEl = document.querySelector(`.light[data-index="${index}"]`);
                if (lightEl) {
                    lightEl.classList.add('selected');
                    state.selectedLight = index;
                }
            }
            
            // Add a new light
            function addLight(x, y) {
                const newLight = {
                    x: x,
                    y: y,
                    type: state.currentType,
                    color: state.currentColor,
                    intensity: state.intensity,
                    beamAngle: state.beamAngle,
                    strobeRate: state.strobeRate
                };
                
                // Add to current scene
                state.scenes[state.currentScene].push(newLight);
                renderLights();
                saveState();
            }
            
            // Delete selected light
            function deleteLight() {
                if (state.selectedLight !== null) {
                    state.scenes[state.currentScene].splice(state.selectedLight, 1);
                    state.selectedLight = null;
                    renderLights();
                    saveState();
                }
            }
            
            // Clear all lights in current scene
            function clearAll() {
                if (confirm('Are you sure you want to clear all lights in this scene?')) {
                    state.scenes[state.currentScene] = [];
                    state.selectedLight = null;
                    renderLights();
                    saveState();
                }
            }
            
            // Apply preset
            function applyPreset(presetName) {
                state.scenes[state.currentScene] = [...state.presets[presetName]];
                renderLights();
                saveState();
            }
            
            // Event listeners
            stage.addEventListener('click', (e) => {
                if (e.target.classList.contains('stage')) {
                    const rect = stage.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    addLight(x, y);
                }
            });
            
            addBtn.addEventListener('click', () => {
                // Add a light in the center of the stage
                const rect = stage.getBoundingClientRect();
                const x = rect.width / 2;
                const y = rect.height / 2;
                addLight(x, y);
            });
            
            deleteBtn.addEventListener('click', () => {
                deleteLight();
            });
            
            clearBtn.addEventListener('click', () => {
                clearAll();
            });
            
            previewBtn.addEventListener('click', () => {
                alert('Preview mode would activate the current scene lighting configuration');
            });
            
            intensitySlider.addEventListener('input', () => {
                state.intensity = parseInt(intensitySlider.value);
                intensityValue.textContent = `${state.intensity}%`;
                
                // Update selected light if exists
                if (state.selectedLight !== null) {
                    state.scenes[state.currentScene][state.selectedLight].intensity = state.intensity;
                    renderLights();
                }
                
                saveState();
            });
            
            angleSlider.addEventListener('input', () => {
                state.beamAngle = parseInt(angleSlider.value);
                angleValue.textContent = `${state.beamAngle}°`;
                
                // Update selected light if exists
                if (state.selectedLight !== null) {
                    state.scenes[state.currentScene][state.selectedLight].beamAngle = state.beamAngle;
                    renderLights();
                }
                
                saveState();
            });
            
            strobeSlider.addEventListener('input', () => {
                state.strobeRate = parseInt(strobeSlider.value);
                strobeValue.textContent = `${state.strobeRate}%`;
                
                // Update selected light if exists
                if (state.selectedLight !== null) {
                    state.scenes[state.currentScene][state.selectedLight].strobeRate = state.strobeRate;
                    renderLights();
                }
                
                saveState();
            });
            
            lightTypeButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    lightTypeButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    state.currentType = btn.dataset.type;
                    saveState();
                });
            });
            
            colorOptions.forEach(option => {
                option.addEventListener('click', () => {
                    colorOptions.forEach(o => o.classList.remove('active'));
                    option.classList.add('active');
                    state.currentColor = option.dataset.color;
                    
                    // Update selected light if exists
                    if (state.selectedLight !== null) {
                        state.scenes[state.currentScene][state.selectedLight].color = state.currentColor;
                        renderLights();
                    }
                    
                    saveState();
                });
            });
            
            sceneButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    sceneButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    state.currentScene = btn.dataset.scene;
                    renderLights();
                    saveState();
                });
            });
            
            presetButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    applyPreset(btn.dataset.preset);
                });
            });
            
            groupItems.forEach(item => {
                item.addEventListener('click', () => {
                    groupItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    state.currentGroup = item.dataset.group;
                });
            });
            
            // Initialize the app
            loadState();
        });
    </script>
</body>
</html>