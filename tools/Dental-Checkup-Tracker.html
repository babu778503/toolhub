<!-- Category: Health -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Dental Checkup Tracker and reminder. Track dental visits, set checkup reminders, maintain oral health records, and monitor dental expenses.">
    <meta name="keywords" content="dental checkup tracker, dental appointment scheduler, oral health tracker, dentist appointment reminder, dental visit scheduler, teeth checkup reminder, dental care tracker, dental expense tracker">
    <title>Dental Checkup Tracker</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 0;
            color: white;
        }

        /* Desktop Header */
        .header-desktop {
            height: 70px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 30px;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            color: white;
        }

        .header-desktop h1 {
            font-size: 1.8rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-desktop h1 i {
            color: #4CAF50;
        }

        /* Mobile Header */
        .header-mobile {
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            color: white;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .header-mobile i {
            margin-right: 10px;
            color: #4CAF50;
        }

        .container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
        }

        .next-appointment {
            font-size: 1.5rem;
            font-weight: 600;
            color: white;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px 40px;
            border-radius: 20px;
            backdrop-filter: blur(5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
            width: 100%;
            max-width: 500px;
        }

        .appointment-details {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            backdrop-filter: blur(5px);
            width: 100%;
            max-width: 500px;
        }

        .appointment-details h3 {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        .progress-container {
            width: 300px;
            height: 300px;
            position: relative;
            margin-bottom: 40px;
        }

        .progress-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            position: relative;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .progress-fill {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            clip-path: polygon(50% 50%, 50% 0%, 100% 0%, 100% 100%, 0% 100%, 0% 0%, 50% 0%);
            background: conic-gradient(#4CAF50 0deg, #4CAF50 0deg, transparent 0deg);
            transition: clip-path 0.1s linear;
        }

        .progress-center {
            width: 260px;
            height: 260px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .progress-text {
            font-size: 1.2rem;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .progress-percent {
            font-size: 2rem;
            font-weight: 700;
            color: #4CAF50;
        }

        .controls {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1.1rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #2196F3, #1976D2);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .btn-reset {
            background: linear-gradient(45deg, #ff9800, #e68900);
            color: white;
        }

        .btn-reset:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .btn-settings {
            background: linear-gradient(45deg, #9c27b0, #7b1fa2);
            color: white;
        }

        .btn-settings:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .btn-add {
            background: linear-gradient(45deg, #00f2fe, #4facfe);
            color: white;
        }

        .btn-add:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .btn-expense {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
        }

        .btn-expense:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .status {
            color: white;
            font-size: 1.3rem;
            font-weight: 500;
            margin-bottom: 20px;
            text-align: center;
            min-height: 1.5em;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 30px;
            border-radius: 25px;
            backdrop-filter: blur(5px);
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
            width: 100%;
            max-width: 800px;
        }

        .dashboard-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(5px);
            transition: transform 0.3s ease;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
        }

        .dashboard-card i {
            font-size: 2rem;
            margin-bottom: 15px;
            color: #4CAF50;
        }

        .dashboard-card h3 {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .dashboard-card .value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #4CAF50;
        }

        .dashboard-card .trend {
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .positive {
            color: #4CAF50;
        }

        .negative {
            color: #f44336;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
            width: 100%;
            max-width: 800px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(5px);
            transition: transform 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-card i {
            font-size: 2rem;
            margin-bottom: 15px;
            color: #4CAF50;
        }

        .feature-card h3 {
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .stats {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 20px;
            margin-top: 30px;
            color: white;
            text-align: center;
            backdrop-filter: blur(5px);
            width: 100%;
            max-width: 500px;
        }

        .stats h3 {
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1.1rem;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .clear-data {
            margin-top: 20px;
        }

        .clear-data .btn {
            background: linear-gradient(45deg, #f44336, #d32f2f);
            padding: 10px 20px;
            font-size: 0.9rem;
        }

        .clear-data .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            font-size: 1.5rem;
        }

        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px;
            border-radius: 10px;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.3);
        }

        .form-row {
            display: flex;
            gap: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .modal-actions .btn {
            padding: 10px 20px;
            font-size: 1rem;
        }

        .history-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .history-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .history-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .history-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .history-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .history-date {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .history-dentist {
            color: #4CAF50;
            font-weight: 500;
        }

        .history-notes {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .expense-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
            backdrop-filter: blur(5px);
            width: 100%;
            max-width: 500px;
        }

        .expense-section h3 {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .expense-summary {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
        }

        .expense-item {
            text-align: center;
        }

        .expense-amount {
            font-size: 1.5rem;
            font-weight: 700;
            color: #ff6b6b;
        }

        .expense-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .notification-list {
            max-height: 200px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .notification-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .notification-time {
            font-weight: 600;
            color: #4CAF50;
        }

        .notification-actions {
            display: flex;
            gap: 10px;
        }

        .notification-actions button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1rem;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            backdrop-filter: blur(5px);
            width: 100%;
            max-width: 600px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .chart-header h3 {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-controls {
            display: flex;
            gap: 10px;
        }

        .chart-controls button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }

        .chart {
            height: 200px;
            display: flex;
            align-items: flex-end;
            gap: 10px;
            padding: 20px 0;
        }

        .chart-bar {
            flex: 1;
            background: linear-gradient(to top, #4CAF50, #8BC34A);
            border-radius: 5px 5px 0 0;
            position: relative;
            min-width: 30px;
        }

        .chart-bar-label {
            position: absolute;
            bottom: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 0.8rem;
        }

        .chart-bar-value {
            position: absolute;
            top: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* Mobile Styles */
        @media (max-width: 768px) {
            .header-desktop {
                display: none;
            }

            .header-mobile {
                display: flex;
            }

            .container {
                padding: 20px 15px;
            }

            .next-appointment {
                font-size: 1.2rem;
                margin-bottom: 20px;
                padding: 15px 25px;
            }

            .progress-container {
                width: 250px;
                height: 250px;
                margin-bottom: 30px;
            }

            .progress-center {
                width: 210px;
                height: 210px;
            }

            .controls {
                gap: 12px;
                flex-wrap: wrap;
                justify-content: center;
            }

            .btn {
                padding: 12px 20px;
                font-size: 1rem;
            }

            .dashboard {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }

            .dashboard-card {
                padding: 15px;
            }

            .dashboard-card .value {
                font-size: 1.5rem;
            }

            .stats {
                width: 100%;
                max-width: 350px;
                padding: 15px;
            }

            .stat-item {
                font-size: 0.9rem;
            }

            .features {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .feature-card {
                padding: 15px;
            }

            .modal-content, .history-content {
                padding: 20px;
                margin: 20px;
                max-width: 90%;
            }

            .expense-section {
                width: 100%;
                max-width: 350px;
                padding: 15px;
            }

            .form-row {
                flex-direction: column;
                gap: 10px;
            }

            .chart {
                height: 150px;
            }
        }

        @media (max-width: 480px) {
            .next-appointment {
                font-size: 1rem;
            }

            .progress-container {
                width: 200px;
                height: 200px;
            }

            .progress-center {
                width: 170px;
                height: 170px;
            }

            .progress-text {
                font-size: 1rem;
            }

            .progress-percent {
                font-size: 1.5rem;
            }

            .stats {
                width: 100%;
                max-width: 300px;
            }

            .btn {
                padding: 10px 15px;
                font-size: 0.9rem;
            }

            .dashboard {
                grid-template-columns: 1fr;
            }

            .dashboard-card .value {
                font-size: 1.3rem;
            }

            .expense-summary {
                flex-direction: column;
                gap: 15px;
            }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .shake {
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .floating {
            animation: floating 3s ease-in-out infinite;
        }

        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        .notification-badge {
            position: relative;
        }

        .badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #f44336;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .overdue {
            color: #f44336;
            animation: pulse 1s infinite;
        }

        .upcoming {
            color: #4CAF50;
        }

        .today {
            color: #ff9800;
        }

        .completed {
            color: #4CAF50;
        }

        .missed {
            color: #f44336;
        }

        .pending {
            color: #ff9800;
        }

        .tab-container {
            width: 100%;
            max-width: 600px;
            margin: 20px 0;
        }

        .tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 5px;
            margin-bottom: 20px;
        }

        .tab {
            flex: 1;
            text-align: center;
            padding: 10px;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: rgba(76, 175, 80, 0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .achievement {
            background: rgba(255, 215, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            backdrop-filter: blur(5px);
            width: 100%;
            max-width: 400px;
            display: none;
        }

        .achievement.show {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .achievement i {
            font-size: 2rem;
            color: gold;
            margin-bottom: 10px;
        }

        .achievement h3 {
            margin-bottom: 10px;
            color: gold;
        }

        .search-bar {
            width: 100%;
            max-width: 500px;
            margin: 20px 0;
            position: relative;
        }

        .search-bar input {
            width: 100%;
            padding: 12px 20px 12px 45px;
            border-radius: 25px;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 1rem;
        }

        .search-bar i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.7);
        }

        .filter-section {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .filter-btn.active {
            background: rgba(76, 175, 80, 0.5);
        }
    </style>
</head>
<body>
    <!-- Desktop Header -->
    <header class="header-desktop">
        <h1><i class="fas fa-calendar-check"></i> Dental Checkup Tracker</h1>
    </header>

    <!-- Mobile Header -->
    <header class="header-mobile">
        <i class="fas fa-calendar-check"></i> Dental Checkup Tracker
    </header>

    <div class="container">
        <div class="next-appointment" id="nextAppointment">
            Next Checkup: <span id="nextCheckupDate" class="upcoming">Loading...</span>
        </div>
        
        <div class="appointment-details">
            <h3><i class="fas fa-info-circle"></i> Appointment Details</h3>
            <div class="detail-item">
                <span>Dentist:</span>
                <span id="dentistName">-</span>
            </div>
            <div class="detail-item">
                <span>Location:</span>
                <span id="location">-</span>
            </div>
            <div class="detail-item">
                <span>Time:</span>
                <span id="appointmentTime">-</span>
            </div>
            <div class="detail-item">
                <span>Type:</span>
                <span id="appointmentType">Regular Checkup</span>
            </div>
            <div class="detail-item">
                <span>Cost:</span>
                <span id="appointmentCost">$0.00</span>
            </div>
        </div>

        <div class="progress-container">
            <div class="progress-circle">
                <div class="progress-fill" id="progressFill"></div>
                <div class="progress-center">
                    <div class="progress-text">Time Until Checkup</div>
                    <div class="progress-percent" id="progressPercent">0%</div>
                </div>
            </div>
        </div>

        <div class="status" id="status">Track your dental health journey!</div>

        <div class="controls">
            <button class="btn btn-primary" id="addAppointmentBtn">
                <i class="fas fa-plus"></i> Add Appointment
            </button>
            <button class="btn btn-secondary" id="viewHistoryBtn">
                <i class="fas fa-history"></i> View History
            </button>
            <button class="btn btn-reset" id="rescheduleBtn">
                <i class="fas fa-sync-alt"></i> Reschedule
            </button>
            <button class="btn btn-settings notification-badge" id="settingsBtn">
                <i class="fas fa-cog"></i> Settings
                <span class="badge" id="notificationBadge">2</span>
            </button>
            <button class="btn btn-expense" id="addExpenseBtn">
                <i class="fas fa-dollar-sign"></i> Add Expense
            </button>
        </div>

        <div class="dashboard">
            <div class="dashboard-card floating">
                <i class="fas fa-calendar-alt"></i>
                <h3>Checkups This Year</h3>
                <div class="value" id="checkupsThisYear">0</div>
                <div class="trend positive">+2 from last year</div>
            </div>
            <div class="dashboard-card floating" style="animation-delay: 0.2s;">
                <i class="fas fa-clock"></i>
                <h3>Days Since Last</h3>
                <div class="value" id="daysSinceLast">0</div>
                <div class="trend">Recommended: 180 days</div>
            </div>
            <div class="dashboard-card floating" style="animation-delay: 0.4s;">
                <i class="fas fa-dollar-sign"></i>
                <h3>Yearly Expenses</h3>
                <div class="value" id="yearlyExpenses">$0</div>
                <div class="trend negative">+$50 from last year</div>
            </div>
            <div class="dashboard-card floating" style="animation-delay: 0.6s;">
                <i class="fas fa-bell"></i>
                <h3>Upcoming Reminders</h3>
                <div class="value" id="upcomingReminders">2</div>
                <div class="trend">2 active</div>
            </div>
        </div>

        <div class="tab-container">
            <div class="tabs">
                <div class="tab active" data-tab="overview">Overview</div>
                <div class="tab" data-tab="expenses">Expenses</div>
                <div class="tab" data-tab="analytics">Analytics</div>
            </div>
            
            <div class="tab-content active" id="overviewTab">
                <div class="features">
                    <div class="feature-card">
                        <i class="fas fa-calendar-plus"></i>
                        <h3>Appointment Scheduling</h3>
                        <p>Easily schedule and manage dental appointments</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-bell"></i>
                        <h3>Smart Reminders</h3>
                        <p>Never miss a dental checkup with timely alerts</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-chart-line"></i>
                        <h3>Health Tracking</h3>
                        <p>Monitor your dental health over time</p>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="expensesTab">
                <div class="expense-section">
                    <h3><i class="fas fa-wallet"></i> Expense Summary</h3>
                    <div class="expense-summary">
                        <div class="expense-item">
                            <div class="expense-amount" id="totalExpenses">$0</div>
                            <div class="expense-label">Total This Year</div>
                        </div>
                        <div class="expense-item">
                            <div class="expense-amount" id="avgExpense">$0</div>
                            <div class="expense-label">Avg. Per Visit</div>
                        </div>
                        <div class="expense-item">
                            <div class="expense-amount" id="monthlyExpense">$0</div>
                            <div class="expense-label">Monthly Avg</div>
                        </div>
                    </div>
                    <button class="btn btn-expense" id="viewExpensesBtn" style="width: 100%; margin-top: 15px;">
                        <i class="fas fa-list"></i> View All Expenses
                    </button>
                </div>
            </div>
            
            <div class="tab-content" id="analyticsTab">
                <div class="chart-container">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-bar"></i> Monthly Checkups</h3>
                        <div class="chart-controls">
                            <button id="prevMonth"><</button>
                            <button id="nextMonth">></button>
                        </div>
                    </div>
                    <div class="chart" id="checkupChart">
                        <!-- Chart bars will be generated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <div class="search-bar">
            <i class="fas fa-search"></i>
            <input type="text" id="searchInput" placeholder="Search appointments, dentists, or procedures...">
        </div>

        <div class="filter-section">
            <button class="filter-btn active" data-filter="all">All</button>
            <button class="filter-btn" data-filter="upcoming">Upcoming</button>
            <button class="filter-btn" data-filter="completed">Completed</button>
            <button class="filter-btn" data-filter="missed">Missed</button>
        </div>

        <div class="stats">
            <h3><i class="fas fa-chart-bar"></i> Dental Statistics</h3>
            <div class="stat-item">
                <span>Total Checkups:</span>
                <span id="totalCheckups">0</span>
            </div>
            <div class="stat-item">
                <span>Longest Gap:</span>
                <span id="longestGap">0 days</span>
            </div>
            <div class="stat-item">
                <span>Avg. Interval:</span>
                <span id="avgInterval">0 days</span>
            </div>
            <div class="stat-item">
                <span>Last Checkup:</span>
                <span id="lastCheckup">Never</span>
            </div>
            <div class="stat-item">
                <span>Next Due:</span>
                <span id="nextDue">-</span>
            </div>
            <div class="stat-item">
                <span>Preferred Dentist:</span>
                <span id="preferredDentist">-</span>
            </div>
            <div class="clear-data">
                <button class="btn" id="clearDataBtn">
                    <i class="fas fa-trash"></i> Clear All Data
                </button>
            </div>
        </div>

        <div class="achievement" id="achievement">
            <i class="fas fa-trophy"></i>
            <h3>Achievement Unlocked!</h3>
            <p id="achievementText">Perfect dental checkup streak!</p>
        </div>
    </div>

    <!-- Add Appointment Modal -->
    <div class="modal" id="appointmentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-calendar-plus"></i> Add New Appointment</h2>
                <button class="close-modal" id="closeAppointmentModal">&times;</button>
            </div>
            <div class="form-group">
                <label for="dentistNameInput">Dentist Name</label>
                <input type="text" id="dentistNameInput" placeholder="Dr. Smith">
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="appointmentDate">Appointment Date</label>
                    <input type="date" id="appointmentDate">
                </div>
                <div class="form-group">
                    <label for="appointmentTimeInput">Appointment Time</label>
                    <input type="time" id="appointmentTimeInput">
                </div>
            </div>
            <div class="form-group">
                <label for="locationInput">Location</label>
                <input type="text" id="locationInput" placeholder="123 Dental Street">
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="appointmentTypeInput">Appointment Type</label>
                    <select id="appointmentTypeInput">
                        <option value="Regular Checkup">Regular Checkup</option>
                        <option value="Cleaning">Cleaning</option>
                        <option value="Filling">Filling</option>
                        <option value="Root Canal">Root Canal</option>
                        <option value="Crown">Crown</option>
                        <option value="Braces">Braces</option>
                        <option value="Wisdom Teeth">Wisdom Teeth</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="appointmentCostInput">Cost ($)</label>
                    <input type="number" id="appointmentCostInput" placeholder="0.00" step="0.01">
                </div>
            </div>
            <div class="form-group">
                <label for="notesInput">Notes</label>
                <textarea id="notesInput" rows="3" placeholder="Any special instructions or notes..."></textarea>
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="completedCheckbox"> Mark as completed
                </label>
            </div>
            <div class="modal-actions">
                <button class="btn btn-reset" id="cancelAppointmentBtn">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button class="btn btn-primary" id="saveAppointmentBtn">
                    <i class="fas fa-save"></i> Save Appointment
                </button>
            </div>
        </div>
    </div>

    <!-- Add Expense Modal -->
    <div class="modal" id="expenseModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-dollar-sign"></i> Add Dental Expense</h2>
                <button class="close-modal" id="closeExpenseModal">&times;</button>
            </div>
            <div class="form-group">
                <label for="expenseDescription">Description</label>
                <input type="text" id="expenseDescription" placeholder="Tooth cleaning, filling, etc.">
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="expenseDate">Date</label>
                    <input type="date" id="expenseDate">
                </div>
                <div class="form-group">
                    <label for="expenseAmount">Amount ($)</label>
                    <input type="number" id="expenseAmount" placeholder="0.00" step="0.01">
                </div>
            </div>
            <div class="form-group">
                <label for="expenseCategory">Category</label>
                <select id="expenseCategory">
                    <option value="Checkup">Checkup</option>
                    <option value="Cleaning">Cleaning</option>
                    <option value="Filling">Filling</option>
                    <option value="Crown">Crown</option>
                    <option value="Root Canal">Root Canal</option>
                    <option value="Braces">Braces</option>
                    <option value="Whitening">Whitening</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label for="expenseNotes">Notes</label>
                <textarea id="expenseNotes" rows="2" placeholder="Additional notes..."></textarea>
            </div>
            <div class="modal-actions">
                <button class="btn btn-reset" id="cancelExpenseBtn">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button class="btn btn-expense" id="saveExpenseBtn">
                    <i class="fas fa-save"></i> Save Expense
                </button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-cog"></i> Tracker Settings</h2>
                <button class="close-modal" id="closeSettingsModal">&times;</button>
            </div>
            <div class="form-group">
                <label for="reminderFrequency">Reminder Frequency</label>
                <select id="reminderFrequency">
                    <option value="14">2 weeks before</option>
                    <option value="7">1 week before</option>
                    <option value="3">3 days before</option>
                    <option value="1">1 day before</option>
                    <option value="0">Same day</option>
                </select>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="defaultInterval">Default Checkup Interval (months)</label>
                    <input type="number" id="defaultInterval" min="1" max="24" value="6">
                </div>
                <div class="form-group">
                    <label for="currency">Currency</label>
                    <select id="currency">
                        <option value="USD">USD ($)</option>
                        <option value="EUR">EUR (€)</option>
                        <option value="GBP">GBP (£)</option>
                        <option value="CAD">CAD (C$)</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="soundEnabled">Sound Alerts</label>
                <select id="soundEnabled">
                    <option value="true">Enabled</option>
                    <option value="false">Disabled</option>
                </select>
            </div>
            <div class="form-group">
                <label for="vibrationEnabled">Vibration Alerts</label>
                <select id="vibrationEnabled">
                    <option value="true">Enabled</option>
                    <option value="false">Disabled</option>
                </select>
            </div>
            <div class="form-group">
                <label for="theme">Theme</label>
                <select id="theme">
                    <option value="default">Default</option>
                    <option value="blue">Ocean Blue</option>
                    <option value="green">Forest Green</option>
                    <option value="purple">Royal Purple</option>
                    <option value="pink">Bubblegum Pink</option>
                    <option value="orange">Sunset Orange</option>
                </select>
            </div>
            <div class="form-group">
                <label for="preferredDentistInput">Preferred Dentist</label>
                <input type="text" id="preferredDentistInput" placeholder="Dr. Johnson">
            </div>
            <div class="form-group">
                <label for="insuranceProvider">Insurance Provider</label>
                <input type="text" id="insuranceProvider" placeholder="Optional">
            </div>
            <div class="modal-actions">
                <button class="btn btn-reset" id="resetSettingsBtn">
                    <i class="fas fa-undo"></i> Reset to Default
                </button>
                <button class="btn btn-primary" id="saveSettingsBtn">
                    <i class="fas fa-save"></i> Save Settings
                </button>
            </div>
        </div>
    </div>

    <!-- History Modal -->
    <div class="history-modal" id="historyModal">
        <div class="history-content">
            <div class="history-header">
                <h2><i class="fas fa-history"></i> Appointment History</h2>
                <button class="close-modal" id="closeHistoryModal">&times;</button>
            </div>
            <div class="search-bar" style="margin: 15px 0;">
                <i class="fas fa-search"></i>
                <input type="text" id="historySearch" placeholder="Search history...">
            </div>
            <div class="filter-section">
                <button class="filter-btn active" data-history-filter="all">All</button>
                <button class="filter-btn" data-history-filter="this-year">This Year</button>
                <button class="filter-btn" data-history-filter="completed">Completed</button>
                <button class="filter-btn" data-history-filter="upcoming">Upcoming</button>
            </div>
            <div class="history-list" id="historyList">
                <!-- History items will be populated here -->
            </div>
        </div>
    </div>

    <script>
        class DentalCheckupTracker {
            constructor() {
                this.appointments = [];
                this.expenses = [];
                this.settings = {
                    reminderFrequency: 7,
                    defaultInterval: 6,
                    soundEnabled: true,
                    vibrationEnabled: true,
                    theme: 'default',
                    preferredDentist: '',
                    currency: 'USD',
                    insuranceProvider: ''
                };
                this.notifications = [];
                this.nextAppointment = null;
                this.achievements = [];
                
                this.initializeElements();
                this.loadSettings();
                this.loadAppointments();
                this.loadExpenses();
                this.loadNotifications();
                this.loadAchievements();
                this.updateDisplay();
                this.setupEventListeners();
                this.applyTheme();
                this.setupTabs();
                this.generateChart();
            }

            initializeElements() {
                this.nextAppointmentEl = document.getElementById('nextAppointment');
                this.nextCheckupDate = document.getElementById('nextCheckupDate');
                this.dentistName = document.getElementById('dentistName');
                this.location = document.getElementById('location');
                this.appointmentTime = document.getElementById('appointmentTime');
                this.appointmentType = document.getElementById('appointmentType');
                this.appointmentCost = document.getElementById('appointmentCost');
                this.progressFill = document.getElementById('progressFill');
                this.progressPercent = document.getElementById('progressPercent');
                this.status = document.getElementById('status');
                this.addAppointmentBtn = document.getElementById('addAppointmentBtn');
                this.viewHistoryBtn = document.getElementById('viewHistoryBtn');
                this.rescheduleBtn = document.getElementById('rescheduleBtn');
                this.settingsBtn = document.getElementById('settingsBtn');
                this.clearDataBtn = document.getElementById('clearDataBtn');
                this.addExpenseBtn = document.getElementById('addExpenseBtn');
                this.checkupsThisYear = document.getElementById('checkupsThisYear');
                this.daysSinceLast = document.getElementById('daysSinceLast');
                this.yearlyExpenses = document.getElementById('yearlyExpenses');
                this.upcomingReminders = document.getElementById('upcomingReminders');
                this.totalCheckups = document.getElementById('totalCheckups');
                this.longestGap = document.getElementById('longestGap');
                this.avgInterval = document.getElementById('avgInterval');
                this.lastCheckup = document.getElementById('lastCheckup');
                this.nextDue = document.getElementById('nextDue');
                this.preferredDentistEl = document.getElementById('preferredDentist');
                this.notificationBadge = document.getElementById('notificationBadge');
                this.viewExpensesBtn = document.getElementById('viewExpensesBtn');
                this.searchInput = document.getElementById('searchInput');
                this.achievementDiv = document.getElementById('achievement');
                this.achievementText = document.getElementById('achievementText');
                
                // Dashboard elements
                this.totalExpenses = document.getElementById('totalExpenses');
                this.avgExpense = document.getElementById('avgExpense');
                this.monthlyExpense = document.getElementById('monthlyExpense');
                
                // Modal elements
                this.appointmentModal = document.getElementById('appointmentModal');
                this.expenseModal = document.getElementById('expenseModal');
                this.settingsModal = document.getElementById('settingsModal');
                this.historyModal = document.getElementById('historyModal');
                
                // Appointment modal elements
                this.closeAppointmentModal = document.getElementById('closeAppointmentModal');
                this.dentistNameInput = document.getElementById('dentistNameInput');
                this.appointmentDate = document.getElementById('appointmentDate');
                this.appointmentTimeInput = document.getElementById('appointmentTimeInput');
                this.locationInput = document.getElementById('locationInput');
                this.appointmentTypeInput = document.getElementById('appointmentTypeInput');
                this.appointmentCostInput = document.getElementById('appointmentCostInput');
                this.notesInput = document.getElementById('notesInput');
                this.completedCheckbox = document.getElementById('completedCheckbox');
                this.cancelAppointmentBtn = document.getElementById('cancelAppointmentBtn');
                this.saveAppointmentBtn = document.getElementById('saveAppointmentBtn');
                
                // Expense modal elements
                this.closeExpenseModal = document.getElementById('closeExpenseModal');
                this.expenseDescription = document.getElementById('expenseDescription');
                this.expenseDate = document.getElementById('expenseDate');
                this.expenseAmount = document.getElementById('expenseAmount');
                this.expenseCategory = document.getElementById('expenseCategory');
                this.expenseNotes = document.getElementById('expenseNotes');
                this.cancelExpenseBtn = document.getElementById('cancelExpenseBtn');
                this.saveExpenseBtn = document.getElementById('saveExpenseBtn');
                
                // Settings modal elements
                this.closeSettingsModal = document.getElementById('closeSettingsModal');
                this.reminderFrequency = document.getElementById('reminderFrequency');
                this.defaultInterval = document.getElementById('defaultInterval');
                this.currency = document.getElementById('currency');
                this.soundEnabled = document.getElementById('soundEnabled');
                this.vibrationEnabled = document.getElementById('vibrationEnabled');
                this.theme = document.getElementById('theme');
                this.preferredDentistInput = document.getElementById('preferredDentistInput');
                this.insuranceProvider = document.getElementById('insuranceProvider');
                this.resetSettingsBtn = document.getElementById('resetSettingsBtn');
                this.saveSettingsBtn = document.getElementById('saveSettingsBtn');
                
                // History modal elements
                this.closeHistoryModal = document.getElementById('closeHistoryModal');
                this.historyList = document.getElementById('historyList');
                this.historySearch = document.getElementById('historySearch');
                
                // Chart elements
                this.checkupChart = document.getElementById('checkupChart');
                this.prevMonthBtn = document.getElementById('prevMonth');
                this.nextMonthBtn = document.getElementById('nextMonth');
                
                // Set default dates
                const today = new Date().toISOString().split('T')[0];
                this.appointmentDate.value = today;
                this.expenseDate.value = today;
            }

            setupEventListeners() {
                this.addAppointmentBtn.addEventListener('click', () => this.openAppointmentModal());
                this.viewHistoryBtn.addEventListener('click', () => this.openHistoryModal());
                this.rescheduleBtn.addEventListener('click', () => this.rescheduleAppointment());
                this.settingsBtn.addEventListener('click', () => this.openSettingsModal());
                this.clearDataBtn.addEventListener('click', () => this.clearData());
                this.addExpenseBtn.addEventListener('click', () => this.openExpenseModal());
                this.viewExpensesBtn.addEventListener('click', () => this.openHistoryModal());
                this.searchInput.addEventListener('input', () => this.filterAppointments());
                
                // Modal events
                this.closeAppointmentModal.addEventListener('click', () => this.closeAppointmentModalFunc());
                this.closeExpenseModal.addEventListener('click', () => this.closeExpenseModalFunc());
                this.closeSettingsModal.addEventListener('click', () => this.closeSettingsModalFunc());
                this.closeHistoryModal.addEventListener('click', () => this.closeHistoryModalFunc());
                this.cancelAppointmentBtn.addEventListener('click', () => this.closeAppointmentModalFunc());
                this.saveAppointmentBtn.addEventListener('click', () => this.saveAppointment());
                this.cancelExpenseBtn.addEventListener('click', () => this.closeExpenseModalFunc());
                this.saveExpenseBtn.addEventListener('click', () => this.saveExpense());
                this.resetSettingsBtn.addEventListener('click', () => this.resetSettings());
                this.saveSettingsBtn.addEventListener('click', () => this.saveSettings());
                
                // Chart navigation
                this.prevMonthBtn.addEventListener('click', () => this.navigateChart(-1));
                this.nextMonthBtn.addEventListener('click', () => this.navigateChart(1));
                
                // Tab switching
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', () => this.switchTab(tab.dataset.tab));
                });
                
                // Filter buttons
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.filterAppointments();
                    });
                });
                
                // History filter
                document.querySelectorAll('[data-history-filter]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('[data-history-filter]').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.filterHistory();
                    });
                });
                
                // History search
                this.historySearch.addEventListener('input', () => this.filterHistory());
                
                // Close modals when clicking outside
                this.appointmentModal.addEventListener('click', (e) => {
                    if (e.target === this.appointmentModal) {
                        this.closeAppointmentModalFunc();
                    }
                });
                
                this.expenseModal.addEventListener('click', (e) => {
                    if (e.target === this.expenseModal) {
                        this.closeExpenseModalFunc();
                    }
                });
                
                this.settingsModal.addEventListener('click', (e) => {
                    if (e.target === this.settingsModal) {
                        this.closeSettingsModalFunc();
                    }
                });
                
                this.historyModal.addEventListener('click', (e) => {
                    if (e.target === this.historyModal) {
                        this.closeHistoryModalFunc();
                    }
                });
            }

            setupTabs() {
                // Tab functionality is handled by event listeners
            }

            switchTab(tabName) {
                // Remove active class from all tabs and content
                document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding content
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
                document.getElementById(`${tabName}Tab`).classList.add('active');
            }

            openAppointmentModal() {
                this.appointmentModal.style.display = 'flex';
            }

            closeAppointmentModalFunc() {
                this.appointmentModal.style.display = 'none';
                this.clearAppointmentForm();
            }

            openExpenseModal() {
                this.expenseModal.style.display = 'flex';
            }

            closeExpenseModalFunc() {
                this.expenseModal.style.display = 'none';
                this.clearExpenseForm();
            }

            openSettingsModal() {
                this.reminderFrequency.value = this.settings.reminderFrequency;
                this.defaultInterval.value = this.settings.defaultInterval;
                this.currency.value = this.settings.currency;
                this.soundEnabled.value = this.settings.soundEnabled.toString();
                this.vibrationEnabled.value = this.settings.vibrationEnabled.toString();
                this.theme.value = this.settings.theme;
                this.preferredDentistInput.value = this.settings.preferredDentist;
                this.insuranceProvider.value = this.settings.insuranceProvider;
                this.settingsModal.style.display = 'flex';
            }

            closeSettingsModalFunc() {
                this.settingsModal.style.display = 'none';
            }

            openHistoryModal() {
                this.loadHistory();
                this.historyModal.style.display = 'flex';
            }

            closeHistoryModalFunc() {
                this.historyModal.style.display = 'none';
            }

            saveAppointment() {
                const appointment = {
                    id: Date.now(),
                    dentist: this.dentistNameInput.value || 'Unknown Dentist',
                    date: this.appointmentDate.value,
                    time: this.appointmentTimeInput.value || '09:00',
                    location: this.locationInput.value || 'Unknown Location',
                    type: this.appointmentTypeInput.value,
                    cost: parseFloat(this.appointmentCostInput.value) || 0,
                    notes: this.notesInput.value,
                    completed: this.completedCheckbox.checked,
                    createdAt: new Date().toISOString()
                };
                
                this.appointments.push(appointment);
                this.saveAppointments();
                this.updateDisplay();
                this.closeAppointmentModalFunc();
                
                // Show success message
                this.status.textContent = 'Appointment added successfully!';
                this.status.classList.add('pulse');
                setTimeout(() => {
                    this.status.classList.remove('pulse');
                }, 2000);
                
                // Check for achievements
                this.checkAchievements();
            }

            saveExpense() {
                const expense = {
                    id: Date.now(),
                    description: this.expenseDescription.value || 'Dental Expense',
                    date: this.expenseDate.value,
                    amount: parseFloat(this.expenseAmount.value) || 0,
                    category: this.expenseCategory.value,
                    notes: this.expenseNotes.value,
                    createdAt: new Date().toISOString()
                };
                
                this.expenses.push(expense);
                this.saveExpenses();
                this.updateDisplay();
                this.closeExpenseModalFunc();
                
                // Show success message
                this.status.textContent = 'Expense added successfully!';
                this.status.classList.add('pulse');
                setTimeout(() => {
                    this.status.classList.remove('pulse');
                }, 2000);
            }

            clearAppointmentForm() {
                this.dentistNameInput.value = '';
                this.locationInput.value = '';
                this.appointmentTimeInput.value = '';
                this.appointmentCostInput.value = '';
                this.notesInput.value = '';
                this.appointmentTypeInput.value = 'Regular Checkup';
                this.completedCheckbox.checked = false;
            }

            clearExpenseForm() {
                this.expenseDescription.value = '';
                this.expenseAmount.value = '';
                this.expenseNotes.value = '';
                this.expenseCategory.value = 'Checkup';
                const today = new Date().toISOString().split('T')[0];
                this.expenseDate.value = today;
            }

            rescheduleAppointment() {
                if (this.nextAppointment) {
                    this.dentistNameInput.value = this.nextAppointment.dentist;
                    this.locationInput.value = this.nextAppointment.location;
                    this.appointmentDate.value = this.nextAppointment.date;
                    this.appointmentTimeInput.value = this.nextAppointment.time;
                    this.appointmentTypeInput.value = this.nextAppointment.type;
                    this.appointmentCostInput.value = this.nextAppointment.cost || '';
                    this.notesInput.value = this.nextAppointment.notes || '';
                    this.completedCheckbox.checked = this.nextAppointment.completed || false;
                    this.appointmentModal.style.display = 'flex';
                } else {
                    this.openAppointmentModal();
                }
            }

            updateDisplay() {
                this.findNextAppointment();
                this.updateNextAppointmentDisplay();
                this.updateProgressCircle();
                this.updateStats();
                this.updateDashboard();
                this.updateExpenseSummary();
                this.setupNotifications();
                this.generateChart();
            }

            findNextAppointment() {
                const today = new Date();
                const futureAppointments = this.appointments.filter(app => {
                    const appDate = new Date(app.date);
                    return appDate >= today && !app.completed;
                });
                
                if (futureAppointments.length > 0) {
                    // Sort by date and get the earliest
                    futureAppointments.sort((a, b) => new Date(a.date) - new Date(b.date));
                    this.nextAppointment = futureAppointments[0];
                } else {
                    this.nextAppointment = null;
                }
            }

            updateNextAppointmentDisplay() {
                if (this.nextAppointment) {
                    const appDate = new Date(this.nextAppointment.date);
                    const formattedDate = appDate.toLocaleDateString();
                    const daysUntil = Math.ceil((appDate - new Date()) / (1000 * 60 * 60 * 24));
                    
                    this.nextCheckupDate.textContent = formattedDate;
                    this.dentistName.textContent = this.nextAppointment.dentist;
                    this.location.textContent = this.nextAppointment.location;
                    this.appointmentTime.textContent = this.nextAppointment.time;
                    this.appointmentType.textContent = this.nextAppointment.type;
                    this.appointmentCost.textContent = `$${this.nextAppointment.cost.toFixed(2)}`;
                    
                    // Set color based on time until appointment
                    if (daysUntil === 0) {
                        this.nextCheckupDate.className = 'today';
                        this.status.textContent = 'Your dental appointment is today!';
                    } else if (daysUntil < 0) {
                        this.nextCheckupDate.className = 'overdue';
                        this.status.textContent = 'You have a past appointment. Consider rescheduling.';
                    } else if (daysUntil <= 7) {
                        this.nextCheckupDate.className = 'today';
                        this.status.textContent = `Your appointment is in ${daysUntil} day${daysUntil !== 1 ? 's' : ''}!`;
                    } else {
                        this.nextCheckupDate.className = 'upcoming';
                        this.status.textContent = `Next appointment in ${daysUntil} days.`;
                    }
                } else {
                    this.nextCheckupDate.textContent = 'No upcoming appointments';
                    this.nextCheckupDate.className = '';
                    this.dentistName.textContent = '-';
                    this.location.textContent = '-';
                    this.appointmentTime.textContent = '-';
                    this.appointmentType.textContent = 'Regular Checkup';
                    this.appointmentCost.textContent = '$0.00';
                    this.status.textContent = 'No upcoming appointments. Schedule one today!';
                }
            }

            updateProgressCircle() {
                if (this.nextAppointment) {
                    const appDate = new Date(this.nextAppointment.date);
                    const today = new Date();
                    const totalDays = 180; // 6 months default
                    const daysUntil = Math.ceil((appDate - today) / (1000 * 60 * 60 * 24));
                    const progress = Math.max(0, Math.min(100, ((totalDays - daysUntil) / totalDays) * 100));
                    
                    this.progressPercent.textContent = `${Math.round(progress)}%`;
                    const angle = (progress / 100) * 360;
                    this.progressFill.style.clipPath = `polygon(50% 50%, 50% 0%, ${angle > 0 ? '100%' : '50%'} 0%, 100% 100%, 0% 100%, 0% ${angle > 180 ? '0%' : '100%'}, 50% ${angle > 90 ? '100%' : '0%'})`;
                } else {
                    this.progressPercent.textContent = '0%';
                    this.progressFill.style.clipPath = 'polygon(50% 50%, 50% 0%, 50% 0%, 100% 100%, 0% 100%, 0% 100%, 50% 100%)';
                }
            }

            updateStats() {
                const now = new Date();
                const thisYear = now.getFullYear();
                
                // Total checkups
                const completedAppointments = this.appointments.filter(app => app.completed);
                this.totalCheckups.textContent = completedAppointments.length;
                
                // Checkups this year
                const thisYearCheckups = completedAppointments.filter(app => {
                    const appYear = new Date(app.date).getFullYear();
                    return appYear === thisYear;
                });
                this.checkupsThisYear.textContent = thisYearCheckups.length;
                
                // Last checkup
                if (completedAppointments.length > 0) {
                    completedAppointments.sort((a, b) => new Date(b.date) - new Date(a.date));
                    const lastCheckupDate = new Date(completedAppointments[0].date);
                    this.lastCheckup.textContent = lastCheckupDate.toLocaleDateString();
                    
                    // Days since last
                    const daysSince = Math.floor((now - lastCheckupDate) / (1000 * 60 * 60 * 24));
                    this.daysSinceLast.textContent = daysSince;
                } else {
                    this.lastCheckup.textContent = 'Never';
                    this.daysSinceLast.textContent = '0';
                }
                
                // Longest gap and average interval
                if (completedAppointments.length > 1) {
                    completedAppointments.sort((a, b) => new Date(a.date) - new Date(b.date));
                    let maxGap = 0;
                    let totalGap = 0;
                    let gapCount = 0;
                    
                    for (let i = 1; i < completedAppointments.length; i++) {
                        const gap = Math.floor((new Date(completedAppointments[i].date) - new Date(completedAppointments[i-1].date)) / (1000 * 60 * 60 * 24));
                        maxGap = Math.max(maxGap, gap);
                        totalGap += gap;
                        gapCount++;
                    }
                    
                    const avgGap = Math.round(totalGap / gapCount);
                    this.longestGap.textContent = `${maxGap} days`;
                    this.avgInterval.textContent = `${avgGap} days`;
                } else {
                    this.longestGap.textContent = '0 days';
                    this.avgInterval.textContent = '0 days';
                }
                
                // Next due
                if (completedAppointments.length > 0) {
                    const lastCheckup = new Date(completedAppointments[completedAppointments.length - 1].date);
                    const nextDueDate = new Date(lastCheckup);
                    nextDueDate.setMonth(nextDueDate.getMonth() + this.settings.defaultInterval);
                    this.nextDue.textContent = nextDueDate.toLocaleDateString();
                } else {
                    this.nextDue.textContent = 'After first checkup';
                }
                
                // Preferred dentist
                this.preferredDentistEl.textContent = this.settings.preferredDentist || '-';
            }

            updateDashboard() {
                const now = new Date();
                const thisYear = now.getFullYear();
                
                // Yearly expenses
                const thisYearExpenses = this.expenses.filter(expense => {
                    const expenseYear = new Date(expense.date).getFullYear();
                    return expenseYear === thisYear;
                });
                
                const totalYearly = thisYearExpenses.reduce((sum, expense) => sum + expense.amount, 0);
                this.yearlyExpenses.textContent = `$${totalYearly.toFixed(2)}`;
                
                // Upcoming reminders
                this.upcomingReminders.textContent = this.notifications.length;
            }

            updateExpenseSummary() {
                const now = new Date();
                const thisYear = now.getFullYear();
                
                // Total expenses this year
                const thisYearExpenses = this.expenses.filter(expense => {
                    const expenseYear = new Date(expense.date).getFullYear();
                    return expenseYear === thisYear;
                });
                
                const totalExpenses = thisYearExpenses.reduce((sum, expense) => sum + expense.amount, 0);
                this.totalExpenses.textContent = `$${totalExpenses.toFixed(2)}`;
                
                // Average expense per visit
                const completedAppointments = this.appointments.filter(app => app.completed);
                const avgExpense = completedAppointments.length > 0 ? totalExpenses / completedAppointments.length : 0;
                this.avgExpense.textContent = `$${avgExpense.toFixed(2)}`;
                
                // Monthly average
                const monthsPassed = now.getMonth() + 1;
                const monthlyAvg = monthsPassed > 0 ? totalExpenses / monthsPassed : 0;
                this.monthlyExpense.textContent = `$${monthlyAvg.toFixed(2)}`;
            }

            generateChart() {
                this.checkupChart.innerHTML = '';
                
                const now = new Date();
                const currentMonth = now.getMonth();
                const currentYear = now.getFullYear();
                
                // Generate data for the last 6 months
                for (let i = 5; i >= 0; i--) {
                    const month = (currentMonth - i + 12) % 12;
                    const year = currentYear - Math.floor((currentMonth - i + 12) / 12);
                    
                    // Count appointments for this month
                    const monthAppointments = this.appointments.filter(app => {
                        const appDate = new Date(app.date);
                        return appDate.getMonth() === month && appDate.getFullYear() === year && app.completed;
                    });
                    
                    const count = monthAppointments.length;
                    const maxCount = Math.max(1, ...this.appointments.map(app => {
                        const appDate = new Date(app.date);
                        return this.appointments.filter(a => 
                            new Date(a.date).getMonth() === appDate.getMonth() && 
                            new Date(a.date).getFullYear() === appDate.getFullYear() && 
                            a.completed
                        ).length;
                    }));
                    
                    const height = maxCount > 0 ? (count / maxCount) * 100 : 0;
                    
                    const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                    
                    const bar = document.createElement('div');
                    bar.className = 'chart-bar';
                    bar.style.height = `${Math.max(10, height)}%`;
                    
                    const value = document.createElement('div');
                    value.className = 'chart-bar-value';
                    value.textContent = count;
                    
                    const label = document.createElement('div');
                    label.className = 'chart-bar-label';
                    label.textContent = monthNames[month];
                    
                    bar.appendChild(value);
                    bar.appendChild(label);
                    this.checkupChart.appendChild(bar);
                }
            }

            navigateChart(direction) {
                // This would implement chart navigation in a more advanced version
                // For now, we'll just regenerate the current chart
                this.generateChart();
            }

            setupNotifications() {
                this.notificationBadge.textContent = this.notifications.length;
                this.notificationBadge.style.display = this.notifications.length > 0 ? 'flex' : 'none';
            }

            filterAppointments() {
                // This would implement search and filter functionality
                this.updateDisplay();
            }

            filterHistory() {
                // This would implement history filtering
                this.loadHistory();
            }

            loadAppointments() {
                const savedAppointments = localStorage.getItem('dentalAppointments');
                if (savedAppointments) {
                    this.appointments = JSON.parse(savedAppointments);
                }
            }

            saveAppointments() {
                localStorage.setItem('dentalAppointments', JSON.stringify(this.appointments));
            }

            loadExpenses() {
                const savedExpenses = localStorage.getItem('dentalExpenses');
                if (savedExpenses) {
                    this.expenses = JSON.parse(savedExpenses);
                }
            }

            saveExpenses() {
                localStorage.setItem('dentalExpenses', JSON.stringify(this.expenses));
            }

            loadSettings() {
                const savedSettings = localStorage.getItem('dentalSettings');
                if (savedSettings) {
                    this.settings = JSON.parse(savedSettings);
                }
            }

            saveSettings() {
                this.settings.reminderFrequency = parseInt(this.reminderFrequency.value);
                this.settings.defaultInterval = parseInt(this.defaultInterval.value);
                this.settings.currency = this.currency.value;
                this.settings.soundEnabled = this.soundEnabled.value === 'true';
                this.settings.vibrationEnabled = this.vibrationEnabled.value === 'true';
                this.settings.theme = this.theme.value;
                this.settings.preferredDentist = this.preferredDentistInput.value;
                this.settings.insuranceProvider = this.insuranceProvider.value;
                
                localStorage.setItem('dentalSettings', JSON.stringify(this.settings));
                this.applyTheme();
                this.updateDisplay();
                this.closeSettingsModalFunc();
            }

            resetSettings() {
                if (confirm('Reset all settings to default?')) {
                    this.settings = {
                        reminderFrequency: 7,
                        defaultInterval: 6,
                        soundEnabled: true,
                        vibrationEnabled: true,
                        theme: 'default',
                        preferredDentist: '',
                        currency: 'USD',
                        insuranceProvider: ''
                    };
                    localStorage.removeItem('dentalSettings');
                    this.applyTheme();
                    this.updateDisplay();
                    this.closeSettingsModalFunc();
                }
            }

            loadNotifications() {
                const savedNotifications = localStorage.getItem('dentalNotifications');
                if (savedNotifications) {
                    this.notifications = JSON.parse(savedNotifications);
                }
            }

            saveNotifications() {
                localStorage.setItem('dentalNotifications', JSON.stringify(this.notifications));
            }

            loadAchievements() {
                const savedAchievements = localStorage.getItem('dentalAchievements');
                if (savedAchievements) {
                    this.achievements = JSON.parse(savedAchievements);
                }
            }

            saveAchievements() {
                localStorage.setItem('dentalAchievements', JSON.stringify(this.achievements));
            }

            checkAchievements() {
                const newAchievements = [];
                const completedAppointments = this.appointments.filter(app => app.completed);
                
                // First appointment achievement
                if (completedAppointments.length === 1 && !this.achievements.includes('first_appointment')) {
                    newAchievements.push({id: 'first_appointment', text: 'First Dental Appointment!'});
                    this.achievements.push('first_appointment');
                }
                
                // 5 appointments achievement
                if (completedAppointments.length >= 5 && !this.achievements.includes('five_appointments')) {
                    newAchievements.push({id: 'five_appointments', text: '5 Dental Checkups Completed!'});
                    this.achievements.push('five_appointments');
                }
                
                // Perfect year achievement
                const now = new Date();
                const thisYear = now.getFullYear();
                const thisYearCheckups = completedAppointments.filter(app => {
                    const appYear = new Date(app.date).getFullYear();
                    return appYear === thisYear;
                });
                
                if (thisYearCheckups.length >= 2 && !this.achievements.includes('perfect_year')) {
                    newAchievements.push({id: 'perfect_year', text: 'Perfect Dental Year!'});
                    this.achievements.push('perfect_year');
                }
                
                if (newAchievements.length > 0) {
                    this.saveAchievements();
                    this.showAchievement(newAchievements[0]);
                }
            }

            showAchievement(achievement) {
                this.achievementText.textContent = achievement.text;
                this.achievementDiv.classList.add('show');
                
                setTimeout(() => {
                    this.achievementDiv.classList.remove('show');
                }, 3000);
            }

            applyTheme() {
                const themes = {
                    default: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                    blue: 'linear-gradient(135deg, #2193b0 0%, #6dd5ed 100%)',
                    green: 'linear-gradient(135deg, #11998e 0%, #38ef7d 100%)',
                    purple: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                    pink: 'linear-gradient(135deg, #ff6b6b 0%, #ffa8a8 100%)',
                    orange: 'linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)'
                };
                
                document.body.style.background = themes[this.settings.theme] || themes.default;
            }

            loadHistory() {
                // Sort appointments by date (newest first)
                const sortedAppointments = [...this.appointments].sort((a, b) => {
                    return new Date(b.date) - new Date(a.date);
                });
                
                this.historyList.innerHTML = '';
                
                if (sortedAppointments.length === 0) {
                    this.historyList.innerHTML = '<div class="history-item">No appointments recorded yet.</div>';
                    return;
                }
                
                sortedAppointments.forEach(appointment => {
                    const appDate = new Date(appointment.date);
                    const formattedDate = appDate.toLocaleDateString();
                    const status = appointment.completed ? 'Completed' : appDate > new Date() ? 'Upcoming' : 'Missed';
                    const statusClass = appointment.completed ? 'completed' : appDate > new Date() ? 'upcoming' : 'missed';
                    
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    historyItem.innerHTML = `
                        <div class="history-item-header">
                            <div class="history-date">${formattedDate}</div>
                            <div class="history-dentist">${appointment.dentist}</div>
                        </div>
                        <div><strong>Time:</strong> ${appointment.time}</div>
                        <div><strong>Type:</strong> ${appointment.type}</div>
                        <div><strong>Cost:</strong> $${appointment.cost.toFixed(2)}</div>
                        <div><strong>Location:</strong> ${appointment.location}</div>
                        <div><strong>Status:</strong> <span class="${statusClass}">${status}</span></div>
                        ${appointment.notes ? `<div class="history-notes"><strong>Notes:</strong> ${appointment.notes}</div>` : ''}
                    `;
                    
                    this.historyList.appendChild(historyItem);
                });
            }

            clearData() {
                if (confirm('Are you sure you want to clear all dental checkup data? This cannot be undone.')) {
                    localStorage.removeItem('dentalAppointments');
                    localStorage.removeItem('dentalExpenses');
                    localStorage.removeItem('dentalSettings');
                    localStorage.removeItem('dentalNotifications');
                    localStorage.removeItem('dentalAchievements');
                    
                    this.appointments = [];
                    this.expenses = [];
                    this.notifications = [];
                    this.achievements = [];
                    this.nextAppointment = null;
                    this.settings = {
                        reminderFrequency: 7,
                        defaultInterval: 6,
                        soundEnabled: true,
                        vibrationEnabled: true,
                        theme: 'default',
                        preferredDentist: '',
                        currency: 'USD',
                        insuranceProvider: ''
                    };
                    
                    this.updateDisplay();
                    this.applyTheme();
                    
                    alert('All dental checkup data has been cleared.');
                }
            }
        }

        // Request notification permission
        if ('Notification' in window) {
            Notification.requestPermission();
        }

        // Initialize the tracker when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            new DentalCheckupTracker();
        });
    </script>
</body>
</html>
